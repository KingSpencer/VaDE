training on: mnist
The current epoch is epoch: 0
WARNING: Found unrecognized keyword args. These are ignored.
  --gamma1
Dataset Summary:
X Data
  total size: 5000 units
  batch size: 1000 units
  num. batches: 5
Allocation Model:  DP mixture with K=0. Concentration gamma0= 5.00
Obs. Data  Model:  Gaussian with full covariance.
Obs. Data  Prior:  Gauss-Wishart on mean and covar of each cluster
  E[  mean[k] ] = 
   [0. 0.]  ...
  E[ covar[k] ] = 
  [[0.1 0. ]
   [0.  0.1]] ...
Initialization:
  initname = randexamples
  K = 1 (number of clusters)
  seed = 1607680
  elapsed_time: 0.0 sec
Learn Alg: memoVB | task  1/1 | alg. seed: 1607680 | data order seed: 8541952
task_output_path: /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
MERGE @ lap 1.00: Disabled. Cannot plan merge on first lap. Need valid SS that represent whole dataset.
    0.200/300 after      0 sec. |   1238.1 MiB | K    1 | loss  2.850458606e+00 |  
    0.400/300 after      0 sec. |   1238.1 MiB | K    1 | loss  2.823862897e+00 |  
    0.600/300 after      0 sec. |   1238.1 MiB | K    1 | loss  2.813524409e+00 |  
    1.000/300 after      0 sec. |   1238.1 MiB | K    1 | loss  2.807927732e+00 |  
MERGE @ lap 2.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    2.000/300 after      0 sec. |   1238.9 MiB | K    5 | loss  2.265143345e+00 | Ndiff  869.561 
MERGE @ lap 3.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    3.000/300 after      0 sec. |   1239.2 MiB | K   15 | loss  2.024788742e+00 | Ndiff  869.561 
MERGE @ lap 4.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    4.000/300 after      1 sec. |   1240.3 MiB | K   15 | loss  1.989580870e+00 | Ndiff   34.208 
MERGE @ lap 5.00 : 2/31 accepted. Ndiff 103.12. 2 skipped.
    5.000/300 after      1 sec. |   1240.3 MiB | K   13 | loss  1.980031042e+00 | Ndiff   19.550 
MERGE @ lap 6.00 : 1/28 accepted. Ndiff 0.00. 0 skipped.
    6.000/300 after      1 sec. |   1240.3 MiB | K   12 | loss  1.974669628e+00 | Ndiff    9.958 
MERGE @ lap 7.00 : 0/21 accepted. Ndiff 0.00. 0 skipped.
    7.000/300 after      1 sec. |   1240.5 MiB | K   12 | loss  1.973123158e+00 | Ndiff    4.970 
MERGE @ lap 8.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
    8.000/300 after      1 sec. |   1240.5 MiB | K   12 | loss  1.972511808e+00 | Ndiff    3.243 
MERGE @ lap 9.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
    9.000/300 after      1 sec. |   1240.5 MiB | K   12 | loss  1.972286248e+00 | Ndiff    1.461 
MERGE @ lap 10.00 : 0/12 accepted. Ndiff 0.00. 0 skipped.
   10.000/300 after      1 sec. |   1240.5 MiB | K   12 | loss  1.972177979e+00 | Ndiff    1.087 
MERGE @ lap 11.00 : 0/21 accepted. Ndiff 0.00. 0 skipped.
   11.000/300 after      1 sec. |   1240.5 MiB | K   12 | loss  1.972106533e+00 | Ndiff    1.468 
MERGE @ lap 12.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   12.000/300 after      1 sec. |   1240.5 MiB | K   12 | loss  1.972054664e+00 | Ndiff    4.112 
MERGE @ lap 13.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   13.000/300 after      1 sec. |   1240.5 MiB | K   12 | loss  1.972016098e+00 | Ndiff    1.501 
MERGE @ lap 14.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   14.000/300 after      2 sec. |   1240.5 MiB | K   12 | loss  1.971984203e+00 | Ndiff    2.254 
MERGE @ lap 15.00 : 0/16 accepted. Ndiff 0.00. 0 skipped.
   15.000/300 after      2 sec. |   1240.5 MiB | K   12 | loss  1.971954567e+00 | Ndiff    1.145 
MERGE @ lap 16.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   16.000/300 after      2 sec. |   1240.5 MiB | K   12 | loss  1.971928118e+00 | Ndiff    1.764 
MERGE @ lap 17.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   17.000/300 after      2 sec. |   1240.5 MiB | K   12 | loss  1.971902848e+00 | Ndiff    1.220 
MERGE @ lap 18.00 : 0/18 accepted. Ndiff 0.00. 0 skipped.
   18.000/300 after      2 sec. |   1240.5 MiB | K   12 | loss  1.971848763e+00 | Ndiff    0.940 
MERGE @ lap 19.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   19.000/300 after      2 sec. |   1240.5 MiB | K   12 | loss  1.971359034e+00 | Ndiff    1.383 
MERGE @ lap 20.00 : 0/11 accepted. Ndiff 0.00. 0 skipped.
   20.000/300 after      2 sec. |   1240.5 MiB | K   12 | loss  1.971001450e+00 | Ndiff    1.632 
MERGE @ lap 21.00 : 0/18 accepted. Ndiff 0.00. 0 skipped.
   21.000/300 after      2 sec. |   1240.5 MiB | K   12 | loss  1.970687075e+00 | Ndiff    4.961 
MERGE @ lap 22.00 : 0/16 accepted. Ndiff 0.00. 0 skipped.
   22.000/300 after      2 sec. |   1240.5 MiB | K   12 | loss  1.970536106e+00 | Ndiff    2.902 
MERGE @ lap 23.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   23.000/300 after      2 sec. |   1240.5 MiB | K   12 | loss  1.970439215e+00 | Ndiff    2.315 
MERGE @ lap 24.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   24.000/300 after      3 sec. |   1240.5 MiB | K   12 | loss  1.970320788e+00 | Ndiff    2.899 
MERGE @ lap 25.00 : 0/11 accepted. Ndiff 0.00. 0 skipped.
   25.000/300 after      3 sec. |   1240.5 MiB | K   12 | loss  1.970151028e+00 | Ndiff    2.606 
MERGE @ lap 26.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   26.000/300 after      3 sec. |   1240.5 MiB | K   12 | loss  1.970005201e+00 | Ndiff    4.837 
MERGE @ lap 27.00 : 0/18 accepted. Ndiff 0.00. 0 skipped.
   27.000/300 after      3 sec. |   1240.5 MiB | K   12 | loss  1.969891894e+00 | Ndiff    2.220 
MERGE @ lap 28.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   28.000/300 after      3 sec. |   1240.5 MiB | K   12 | loss  1.969753716e+00 | Ndiff    2.403 
MERGE @ lap 29.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   29.000/300 after      3 sec. |   1240.5 MiB | K   12 | loss  1.969526835e+00 | Ndiff    3.123 
MERGE @ lap 30.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   30.000/300 after      3 sec. |   1240.5 MiB | K   12 | loss  1.968972793e+00 | Ndiff    5.552 
MERGE @ lap 31.00 : 0/16 accepted. Ndiff 0.00. 0 skipped.
   31.000/300 after      3 sec. |   1240.5 MiB | K   12 | loss  1.968740360e+00 | Ndiff    3.271 
MERGE @ lap 32.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   32.000/300 after      3 sec. |   1240.5 MiB | K   12 | loss  1.968636605e+00 | Ndiff    1.873 
MERGE @ lap 33.00 : 0/18 accepted. Ndiff 0.00. 0 skipped.
   33.000/300 after      3 sec. |   1240.5 MiB | K   12 | loss  1.968579821e+00 | Ndiff    1.824 
MERGE @ lap 34.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   34.000/300 after      4 sec. |   1240.5 MiB | K   12 | loss  1.968532619e+00 | Ndiff    1.439 
MERGE @ lap 35.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   35.000/300 after      4 sec. |   1240.5 MiB | K   12 | loss  1.968477913e+00 | Ndiff    1.277 
MERGE @ lap 36.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   36.000/300 after      4 sec. |   1240.5 MiB | K   12 | loss  1.968408423e+00 | Ndiff    1.617 
MERGE @ lap 37.00 : 0/16 accepted. Ndiff 0.00. 0 skipped.
   37.000/300 after      4 sec. |   1240.5 MiB | K   12 | loss  1.968304058e+00 | Ndiff    1.699 
MERGE @ lap 38.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   38.000/300 after      4 sec. |   1240.5 MiB | K   12 | loss  1.968176484e+00 | Ndiff    2.390 
MERGE @ lap 39.00 : 0/18 accepted. Ndiff 0.00. 0 skipped.
   39.000/300 after      4 sec. |   1240.5 MiB | K   12 | loss  1.968042508e+00 | Ndiff    2.840 
MERGE @ lap 40.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   40.000/300 after      4 sec. |   1240.5 MiB | K   12 | loss  1.967916151e+00 | Ndiff    2.475 
MERGE @ lap 41.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   41.000/300 after      4 sec. |   1240.5 MiB | K   12 | loss  1.967778391e+00 | Ndiff    2.603 
MERGE @ lap 42.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   42.000/300 after      4 sec. |   1240.5 MiB | K   12 | loss  1.967663076e+00 | Ndiff    2.369 
MERGE @ lap 43.00 : 0/16 accepted. Ndiff 0.00. 0 skipped.
   43.000/300 after      4 sec. |   1240.5 MiB | K   12 | loss  1.967567577e+00 | Ndiff    8.104 
MERGE @ lap 44.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   44.000/300 after      5 sec. |   1240.5 MiB | K   12 | loss  1.967484061e+00 | Ndiff    1.864 
MERGE @ lap 45.00 : 0/18 accepted. Ndiff 0.00. 0 skipped.
   45.000/300 after      5 sec. |   1240.5 MiB | K   12 | loss  1.967397650e+00 | Ndiff    1.417 
MERGE @ lap 46.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   46.000/300 after      5 sec. |   1240.5 MiB | K   12 | loss  1.967308479e+00 | Ndiff    1.017 
MERGE @ lap 47.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   47.000/300 after      5 sec. |   1240.5 MiB | K   12 | loss  1.967215594e+00 | Ndiff    1.336 
MERGE @ lap 48.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   48.000/300 after      5 sec. |   1240.5 MiB | K   12 | loss  1.967100015e+00 | Ndiff    1.253 
MERGE @ lap 49.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   49.000/300 after      5 sec. |   1240.5 MiB | K   12 | loss  1.966939858e+00 | Ndiff    1.024 
MERGE @ lap 50.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   50.000/300 after      5 sec. |   1240.5 MiB | K   12 | loss  1.966687987e+00 | Ndiff    2.021 
MERGE @ lap 51.00 : 0/16 accepted. Ndiff 0.00. 0 skipped.
   51.000/300 after      5 sec. |   1240.5 MiB | K   12 | loss  1.966301172e+00 | Ndiff    3.311 
MERGE @ lap 52.00 : 0/18 accepted. Ndiff 0.00. 0 skipped.
   52.000/300 after      5 sec. |   1240.5 MiB | K   12 | loss  1.965973609e+00 | Ndiff    2.617 
MERGE @ lap 53.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   53.000/300 after      5 sec. |   1240.5 MiB | K   12 | loss  1.965823703e+00 | Ndiff    2.298 
MERGE @ lap 54.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   54.000/300 after      6 sec. |   1240.5 MiB | K   12 | loss  1.965706947e+00 | Ndiff    1.492 
MERGE @ lap 55.00 : 0/15 accepted. Ndiff 0.00. 0 skipped.
   55.000/300 after      6 sec. |   1240.5 MiB | K   12 | loss  1.965620949e+00 | Ndiff    1.658 
MERGE @ lap 56.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   56.000/300 after      6 sec. |   1240.5 MiB | K   12 | loss  1.965559771e+00 | Ndiff    0.790 
MERGE @ lap 57.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   57.000/300 after      6 sec. |   1240.5 MiB | K   12 | loss  1.965477794e+00 | Ndiff    1.101 
MERGE @ lap 58.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   58.000/300 after      6 sec. |   1240.5 MiB | K   12 | loss  1.965342211e+00 | Ndiff    0.813 
MERGE @ lap 59.00 : 0/11 accepted. Ndiff 0.00. 0 skipped.
   59.000/300 after      6 sec. |   1240.5 MiB | K   12 | loss  1.965134090e+00 | Ndiff    1.051 
MERGE @ lap 60.00 : 0/18 accepted. Ndiff 0.00. 0 skipped.
   60.000/300 after      6 sec. |   1240.5 MiB | K   12 | loss  1.964809073e+00 | Ndiff    1.090 
MERGE @ lap 61.00 : 0/2 accepted. Ndiff 0.00. 0 skipped.
   61.000/300 after      6 sec. |   1240.8 MiB | K   12 | loss  1.964540313e+00 | Ndiff    1.133 
MERGE @ lap 62.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   62.000/300 after      6 sec. |   1240.8 MiB | K   12 | loss  1.964385258e+00 | Ndiff    1.543 
MERGE @ lap 63.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   63.000/300 after      6 sec. |   1240.8 MiB | K   12 | loss  1.964170325e+00 | Ndiff    1.869 
MERGE @ lap 64.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   64.000/300 after      6 sec. |   1240.8 MiB | K   12 | loss  1.963957466e+00 | Ndiff    1.018 
MERGE @ lap 65.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   65.000/300 after      7 sec. |   1240.8 MiB | K   12 | loss  1.963853270e+00 | Ndiff    1.670 
MERGE @ lap 66.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   66.000/300 after      7 sec. |   1240.8 MiB | K   12 | loss  1.963754039e+00 | Ndiff    1.234 
MERGE @ lap 67.00 : 0/11 accepted. Ndiff 0.00. 0 skipped.
   67.000/300 after      7 sec. |   1240.8 MiB | K   12 | loss  1.963643080e+00 | Ndiff    1.508 
MERGE @ lap 68.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   68.000/300 after      7 sec. |   1240.8 MiB | K   12 | loss  1.963565592e+00 | Ndiff    0.825 
MERGE @ lap 69.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   69.000/300 after      7 sec. |   1240.8 MiB | K   12 | loss  1.963501979e+00 | Ndiff    0.974 
MERGE @ lap 70.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   70.000/300 after      7 sec. |   1240.8 MiB | K   12 | loss  1.963444111e+00 | Ndiff    0.872 
MERGE @ lap 71.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   71.000/300 after      7 sec. |   1240.8 MiB | K   12 | loss  1.963398620e+00 | Ndiff    0.494 
MERGE @ lap 72.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   72.000/300 after      7 sec. |   1240.8 MiB | K   12 | loss  1.963324047e+00 | Ndiff    0.663 
MERGE @ lap 73.00 : 0/6 accepted. Ndiff 0.00. 0 skipped.
   73.000/300 after      7 sec. |   1240.8 MiB | K   12 | loss  1.963265237e+00 | Ndiff    0.793 
MERGE @ lap 74.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   74.000/300 after      7 sec. |   1240.8 MiB | K   12 | loss  1.963254339e+00 | Ndiff    0.185 
MERGE @ lap 75.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   75.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963249770e+00 | Ndiff    0.141 
MERGE @ lap 76.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   76.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963243829e+00 | Ndiff    0.213 
MERGE @ lap 77.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   77.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963236558e+00 | Ndiff    0.245 
MERGE @ lap 78.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   78.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963229953e+00 | Ndiff    0.181 
MERGE @ lap 79.00 : 0/6 accepted. Ndiff 0.00. 0 skipped.
   79.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963220946e+00 | Ndiff    0.251 
MERGE @ lap 80.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   80.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963198447e+00 | Ndiff    0.338 
MERGE @ lap 81.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   81.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963169626e+00 | Ndiff    0.543 
MERGE @ lap 82.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   82.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963162381e+00 | Ndiff    0.165 
MERGE @ lap 83.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   83.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963161692e+00 | Ndiff    0.067 
MERGE @ lap 84.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   84.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963161576e+00 | Ndiff    0.046 
MERGE @ lap 85.00 : 0/6 accepted. Ndiff 0.00. 0 skipped.
   85.000/300 after      8 sec. |   1240.8 MiB | K   12 | loss  1.963161547e+00 | Ndiff    0.029 
MERGE @ lap 86.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   86.000/300 after      9 sec. |   1240.8 MiB | K   12 | loss  1.963161538e+00 | Ndiff    0.019 
MERGE @ lap 87.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   87.000/300 after      9 sec. |   1240.8 MiB | K   12 | loss  1.963161535e+00 | Ndiff    0.013 
MERGE @ lap 88.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   88.000/300 after      9 sec. |   1240.8 MiB | K   12 | loss  1.963161534e+00 | Ndiff    0.008 
MERGE @ lap 89.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   89.000/300 after      9 sec. |   1240.8 MiB | K   12 | loss  1.963161533e+00 | Ndiff    0.006 
... done. converged.
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.1012 0.1158 0.1014 0.0946 0.092  0.0864 0.0978 0.1144 0.0988 0.0976]
The cluster evaluation result is 

NMI => 0.859499485972183
ARS => 0.8296075804599995
HS => 0.8895360407163312
CS => 0.8304771617702528
VM => 0.8589926697288929
Precision: 0.9831460674157303, Recall: 0.9178321678321678, fitted: 0, true: 7
Precision: 0.9978947368421053, Recall: 0.9367588932806324, fitted: 1, true: 0
Precision: 0.9719222462203023, Recall: 0.9109311740890689, fitted: 2, true: 8
Precision: 0.96529284164859, Recall: 0.9118852459016393, fitted: 3, true: 9
Precision: 0.9867549668874173, Recall: 0.8816568047337278, fitted: 4, true: 2
Precision: 0.9845132743362832, Recall: 0.9100204498977505, fitted: 5, true: 6
Precision: 0.9815242494226328, Recall: 0.9239130434782609, fitted: 6, true: 4
Precision: 0.9813084112149533, Recall: 0.8879492600422833, fitted: 7, true: 3
Precision: 0.9799498746867168, Recall: 0.9050925925925926, fitted: 8, true: 5
Precision: 0.1523545706371191, Recall: 0.10848126232741617, fitted: 9, true: 2
Precision: 1.0, Recall: 0.6010362694300518, fitted: 10, true: 1
Precision: 1.0, Recall: 0.3333333333333333, fitted: 11, true: 1
The current ACC is :0.9165857142857143
Iteration: 0-0, ELBO: -951186.5625
Iteration: 0-1, ELBO: -928137.5
Iteration: 0-2, ELBO: -902628.9375
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0974 0.1116 0.1008 0.1086 0.0972 0.0838 0.0994 0.106  0.0996 0.0956]
The cluster evaluation result is 

NMI => 0.004317744443371436
ARS => 1.8078148314703023e-05
HS => 0.004467710914688533
CS => 0.004172811856956193
VM => 0.00431522896726681
Precision: 0.1198501872659176, Recall: 0.1285140562248996, fitted: 0, true: 8
Precision: 0.12210526315789473, Recall: 0.1039426523297491, fitted: 1, true: 1
Precision: 0.11879049676025918, Recall: 0.10128913443830571, fitted: 2, true: 3
Precision: 0.11713665943600868, Recall: 0.10714285714285714, fitted: 3, true: 2
Precision: 0.12582781456953643, Recall: 0.10497237569060773, fitted: 4, true: 3
Precision: 0.12831858407079647, Recall: 0.1039426523297491, fitted: 5, true: 1
Precision: 0.12240184757505773, Recall: 0.10663983903420524, fitted: 6, true: 6
Precision: 0.15186915887850466, Recall: 0.12264150943396226, fitted: 7, true: 7
Precision: 0.13533834586466165, Recall: 0.0967741935483871, fitted: 8, true: 1
Precision: 0.1329639889196676, Recall: 0.08602150537634409, fitted: 9, true: 1
Precision: 0.13505747126436782, Recall: 0.08867924528301886, fitted: 10, true: 7
Precision: 0.13471502590673576, Recall: 0.05439330543933055, fitted: 11, true: 9
The current ACC is :0.9193428571428571
Iteration: 1-0, ELBO: -2540988.25
Iteration: 1-1, ELBO: -2326739.0
Iteration: 1-2, ELBO: -2105815.75
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.1002 0.1062 0.1042 0.0996 0.091  0.0956 0.0966 0.1092 0.0964 0.101 ]
The cluster evaluation result is 

NMI => 0.0035159663293039306
ARS => -0.0002774494769991711
HS => 0.0036369628758096133
CS => 0.0033989951646253977
VM => 0.0035139547898823597
Precision: 0.1198501872659176, Recall: 0.13250517598343686, fitted: 0, true: 6
Precision: 0.11789473684210526, Recall: 0.11715481171548117, fitted: 1, true: 5
Precision: 0.12311015118790497, Recall: 0.10734463276836158, fitted: 2, true: 1
Precision: 0.12147505422993492, Recall: 0.11089108910891089, fitted: 3, true: 9
Precision: 0.1280353200883002, Recall: 0.11132437619961612, fitted: 4, true: 2
Precision: 0.1172566371681416, Recall: 0.1017274472168906, fitted: 5, true: 2
Precision: 0.12240184757505773, Recall: 0.10642570281124498, fitted: 6, true: 3
Precision: 0.1261682242990654, Recall: 0.11297071129707113, fitted: 7, true: 5
Precision: 0.14536340852130325, Recall: 0.10622710622710622, fitted: 8, true: 7
Precision: 0.11634349030470914, Recall: 0.08433734939759036, fitted: 9, true: 3
Precision: 0.12643678160919541, Recall: 0.08286252354048965, fitted: 10, true: 1
Precision: 0.12435233160621761, Recall: 0.046065259117082535, fitted: 11, true: 2
The current ACC is :0.9363571428571429
Iteration: 2-0, ELBO: -1878383.875
Iteration: 2-1, ELBO: -1715715.625
Iteration: 2-2, ELBO: -1582343.125
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0998 0.1048 0.1016 0.1024 0.0964 0.0946 0.0984 0.1068 0.095  0.1002]
The cluster evaluation result is 

NMI => 0.003468707635560487
ARS => -0.0003513543658356574
HS => 0.0035876126636813174
CS => 0.0033537435026916845
VM => 0.003466738306639163
Precision: 0.11610486891385768, Recall: 0.11610486891385768, fitted: 0, true: 7
Precision: 0.13052631578947368, Recall: 0.11610486891385768, fitted: 1, true: 7
Precision: 0.11879049676025918, Recall: 0.10826771653543307, fitted: 2, true: 2
Precision: 0.11713665943600868, Recall: 0.10305343511450382, fitted: 3, true: 1
Precision: 0.12141280353200883, Recall: 0.1049618320610687, fitted: 4, true: 1
Precision: 0.12831858407079647, Recall: 0.10861423220973783, fitted: 5, true: 7
Precision: 0.11547344110854503, Recall: 0.10570824524312897, fitted: 6, true: 5
Precision: 0.10981308411214953, Recall: 0.09251968503937008, fitted: 7, true: 2
Precision: 0.11779448621553884, Recall: 0.09251968503937008, fitted: 8, true: 2
Precision: 0.14127423822714683, Recall: 0.09550561797752809, fitted: 9, true: 7
Precision: 0.13218390804597702, Recall: 0.09181636726546906, fitted: 10, true: 9
Precision: 0.14507772020725387, Recall: 0.058091286307053944, fitted: 11, true: 4
The current ACC is :0.2305
Iteration: 3-0, ELBO: -1475692.5
Iteration: 3-1, ELBO: -1388522.5
Iteration: 3-2, ELBO: -1317826.0
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0946 0.109  0.101  0.1028 0.0906 0.0972 0.0966 0.1038 0.105  0.0994]
The cluster evaluation result is 

NMI => 0.004326878810999111
ARS => 2.709121845313314e-06
HS => 0.0044757855325975315
CS => 0.004182926127429479
VM => 0.004324403209198602
Precision: 0.1198501872659176, Recall: 0.12673267326732673, fitted: 0, true: 2
Precision: 0.11789473684210526, Recall: 0.11839323467230443, fitted: 1, true: 0
Precision: 0.14038876889848811, Recall: 0.1337448559670782, fitted: 2, true: 5
Precision: 0.12581344902386118, Recall: 0.11485148514851486, fitted: 3, true: 2
Precision: 0.11920529801324503, Recall: 0.10505836575875487, fitted: 4, true: 3
Precision: 0.13495575221238937, Recall: 0.11619047619047619, fitted: 5, true: 8
Precision: 0.13163972286374134, Recall: 0.11089494163424124, fitted: 6, true: 3
Precision: 0.1191588785046729, Recall: 0.10261569416498995, fitted: 7, true: 9
Precision: 0.12781954887218044, Recall: 0.09357798165137615, fitted: 8, true: 1
Precision: 0.11357340720221606, Recall: 0.0789980732177264, fitted: 9, true: 7
Precision: 0.1206896551724138, Recall: 0.08316831683168317, fitted: 10, true: 2
Precision: 0.17098445595854922, Recall: 0.06285714285714286, fitted: 11, true: 8
The current ACC is :0.2449
Iteration: 4-0, ELBO: -1250304.125
Iteration: 4-1, ELBO: -1203396.125
Iteration: 4-2, ELBO: -1163668.375
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.1004 0.118  0.0982 0.1036 0.0998 0.0858 0.0988 0.097  0.097  0.1014]
The cluster evaluation result is 

NMI => 0.004188666060753726
ARS => -8.440393446733703e-06
HS => 0.004334175773030939
CS => 0.004048041493305836
VM => 0.004186224911866948
Precision: 0.1254681647940075, Recall: 0.13214990138067062, fitted: 0, true: 9
Precision: 0.12631578947368421, Recall: 0.1016949152542373, fitted: 1, true: 1
Precision: 0.13822894168466524, Recall: 0.12955465587044535, fitted: 2, true: 6
Precision: 0.11713665943600868, Recall: 0.10931174089068826, fitted: 3, true: 6
Precision: 0.11920529801324503, Recall: 0.10821643286573146, fitted: 4, true: 4
Precision: 0.12168141592920353, Recall: 0.09322033898305085, fitted: 5, true: 1
Precision: 0.12009237875288684, Recall: 0.08813559322033898, fitted: 6, true: 1
Precision: 0.1261682242990654, Recall: 0.09152542372881356, fitted: 7, true: 1
Precision: 0.13283208020050125, Recall: 0.1079429735234216, fitted: 8, true: 2
Precision: 0.13850415512465375, Recall: 0.099601593625498, fitted: 9, true: 0
Precision: 0.12643678160919541, Recall: 0.07457627118644068, fitted: 10, true: 1
Precision: 0.12953367875647667, Recall: 0.0423728813559322, fitted: 11, true: 1
The current ACC is :0.24084285714285714
Iteration: 5-0, ELBO: -1137053.375
Iteration: 5-1, ELBO: -1107518.625
Iteration: 5-2, ELBO: -1080628.125
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0982 0.119  0.096  0.1114 0.0962 0.0928 0.0932 0.0974 0.0996 0.0962]
The cluster evaluation result is 

NMI => 0.0049859992516441175
ARS => 0.00026233537249061077
HS => 0.005159575550866318
CS => 0.00481826233423824
VM => 0.004983081269441809
Precision: 0.11235955056179775, Recall: 0.12474012474012475, fitted: 0, true: 4
Precision: 0.12631578947368421, Recall: 0.10771992818671454, fitted: 1, true: 3
Precision: 0.12526997840172785, Recall: 0.09747899159663866, fitted: 2, true: 1
Precision: 0.1193058568329718, Recall: 0.11434511434511435, fitted: 3, true: 9
Precision: 0.1434878587196468, Recall: 0.1092436974789916, fitted: 4, true: 1
Precision: 0.1261061946902655, Recall: 0.1144578313253012, fitted: 5, true: 8
Precision: 0.13856812933025403, Recall: 0.10771992818671454, fitted: 6, true: 3
Precision: 0.1378504672897196, Recall: 0.12114989733059549, fitted: 7, true: 7
Precision: 0.12030075187969924, Recall: 0.0997920997920998, fitted: 8, true: 4
Precision: 0.13573407202216067, Recall: 0.08235294117647059, fitted: 9, true: 1
Precision: 0.12931034482758622, Recall: 0.0807899461400359, fitted: 10, true: 3
Precision: 0.14507772020725387, Recall: 0.058212058212058215, fitted: 11, true: 9
The current ACC is :0.24168571428571428
Iteration: 6-0, ELBO: -1056918.0
Iteration: 6-1, ELBO: -1034456.5625
Iteration: 6-2, ELBO: -1012362.625
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.1006 0.1128 0.0964 0.0966 0.1    0.089  0.0972 0.1054 0.0964 0.1056]
The cluster evaluation result is 

NMI => 0.004853687925925341
ARS => 0.00036986048663833294
HS => 0.0050213866182120285
CS => 0.004691589848276187
VM => 0.004850889233296183
Precision: 0.12172284644194757, Recall: 0.11524822695035461, fitted: 0, true: 1
Precision: 0.12210526315789473, Recall: 0.11005692599620494, fitted: 1, true: 7
Precision: 0.13822894168466524, Recall: 0.11347517730496454, fitted: 2, true: 1
Precision: 0.1301518438177874, Recall: 0.10638297872340426, fitted: 3, true: 1
Precision: 0.12362030905077263, Recall: 0.11618257261410789, fitted: 4, true: 2
Precision: 0.1172566371681416, Recall: 0.10995850622406639, fitted: 5, true: 8
Precision: 0.12240184757505773, Recall: 0.09397163120567376, fitted: 6, true: 1
Precision: 0.13551401869158877, Recall: 0.116, fitted: 7, true: 4
Precision: 0.12280701754385964, Recall: 0.10144927536231885, fitted: 8, true: 3
Precision: 0.12742382271468145, Recall: 0.08712121212121213, fitted: 9, true: 9
Precision: 0.13505747126436782, Recall: 0.08901515151515152, fitted: 10, true: 9
Precision: 0.12953367875647667, Recall: 0.05186721991701245, fitted: 11, true: 2
The current ACC is :0.2450857142857143
Iteration: 7-0, ELBO: -989976.1875
Iteration: 7-1, ELBO: -969890.8125
Iteration: 7-2, ELBO: -950311.5
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0972 0.114  0.1052 0.0982 0.0942 0.0838 0.1028 0.1038 0.1    0.1008]
The cluster evaluation result is 

NMI => 0.0033396915571723374
ARS => -0.00045213343678613934
HS => 0.003455724406974588
CS => 0.003227554742078774
VM => 0.003337744675419703
Precision: 0.11610486891385768, Recall: 0.12627291242362526, fitted: 0, true: 3
Precision: 0.12, Recall: 0.1, fitted: 1, true: 1
Precision: 0.13606911447084233, Recall: 0.11977186311787072, fitted: 2, true: 2
Precision: 0.1279826464208243, Recall: 0.10350877192982456, fitted: 3, true: 1
Precision: 0.12362030905077263, Recall: 0.09824561403508772, fitted: 4, true: 1
Precision: 0.11061946902654868, Recall: 0.102880658436214, fitted: 5, true: 0
Precision: 0.11778290993071594, Recall: 0.09826589595375723, fitted: 6, true: 7
Precision: 0.11682242990654206, Recall: 0.102880658436214, fitted: 7, true: 0
Precision: 0.12030075187969924, Recall: 0.09775967413441955, fitted: 8, true: 3
Precision: 0.11911357340720222, Recall: 0.07543859649122807, fitted: 9, true: 1
Precision: 0.12643678160919541, Recall: 0.08365019011406843, fitted: 10, true: 2
Precision: 0.13989637305699482, Recall: 0.05357142857142857, fitted: 11, true: 9
The current ACC is :0.2546
Iteration: 8-0, ELBO: -932282.375
Iteration: 8-1, ELBO: -914603.5
Iteration: 8-2, ELBO: -895710.625
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0954 0.1172 0.0996 0.0992 0.1002 0.0944 0.0986 0.1046 0.085  0.1058]
The cluster evaluation result is 

NMI => 0.003412526996888337
ARS => -0.00023873006122589015
HS => 0.003531349283686014
CS => 0.003297702823759295
VM => 0.003410529110415049
Precision: 0.1254681647940075, Recall: 0.12810707456978968, fitted: 0, true: 7
Precision: 0.12631578947368421, Recall: 0.12170385395537525, fitted: 1, true: 6
Precision: 0.13174946004319654, Recall: 0.10409556313993173, fitted: 2, true: 1
Precision: 0.1301518438177874, Recall: 0.10238907849829351, fitted: 3, true: 1
Precision: 0.12582781456953643, Recall: 0.1144578313253012, fitted: 4, true: 2
Precision: 0.1261061946902655, Recall: 0.09726962457337884, fitted: 5, true: 1
Precision: 0.13394919168591224, Recall: 0.11693548387096774, fitted: 6, true: 3
Precision: 0.12850467289719625, Recall: 0.09385665529010238, fitted: 7, true: 1
Precision: 0.11027568922305764, Recall: 0.09322033898305085, fitted: 8, true: 5
Precision: 0.12465373961218837, Recall: 0.09533898305084745, fitted: 9, true: 5
Precision: 0.12643678160919541, Recall: 0.09224318658280922, fitted: 10, true: 0
Precision: 0.13471502590673576, Recall: 0.0497131931166348, fitted: 11, true: 7
The current ACC is :0.26825714285714286
Iteration: 9-0, ELBO: -874049.0
Iteration: 9-1, ELBO: -856570.875
Iteration: 9-2, ELBO: -838992.5
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0966 0.1076 0.1006 0.1058 0.1012 0.0894 0.0988 0.1008 0.104  0.0952]
The cluster evaluation result is 

NMI => 0.005343976870416098
ARS => 0.0006136177321429753
HS => 0.00552784712005561
CS => 0.005166222612765553
VM => 0.005340920623304824
Precision: 0.12734082397003746, Recall: 0.14285714285714285, fitted: 0, true: 9
Precision: 0.12, Recall: 0.11538461538461539, fitted: 1, true: 6
Precision: 0.12311015118790497, Recall: 0.10594795539033457, fitted: 2, true: 1
Precision: 0.14099783080260303, Recall: 0.125, fitted: 3, true: 8
Precision: 0.13245033112582782, Recall: 0.1214574898785425, fitted: 4, true: 6
Precision: 0.12168141592920353, Recall: 0.12304250559284116, fitted: 5, true: 5
Precision: 0.11547344110854503, Recall: 0.10504201680672269, fitted: 6, true: 9
Precision: 0.11682242990654206, Recall: 0.0945179584120983, fitted: 7, true: 3
Precision: 0.12531328320802004, Recall: 0.09940357852882704, fitted: 8, true: 2
Precision: 0.13019390581717452, Recall: 0.09038461538461538, fitted: 9, true: 8
Precision: 0.13218390804597702, Recall: 0.1029082774049217, fitted: 10, true: 5
Precision: 0.12953367875647667, Recall: 0.051759834368530024, fitted: 11, true: 0
The current ACC is :0.28515714285714283
Iteration: 10-0, ELBO: -837843.9375
Iteration: 10-1, ELBO: -822175.4375
Iteration: 10-2, ELBO: -806167.125
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.101  0.1096 0.1006 0.0958 0.1006 0.0932 0.0986 0.1012 0.0994 0.1   ]
The cluster evaluation result is 

NMI => 0.004026002651377069
ARS => -0.00018320191428641765
HS => 0.004164070071237341
CS => 0.0038925131113556944
VM => 0.004023715012070011
Precision: 0.1198501872659176, Recall: 0.1272365805168986, fitted: 0, true: 2
Precision: 0.12631578947368421, Recall: 0.11928429423459244, fitted: 1, true: 4
Precision: 0.11231101511879049, Recall: 0.10297029702970296, fitted: 2, true: 0
Precision: 0.12147505422993492, Recall: 0.11089108910891089, fitted: 3, true: 0
Precision: 0.13245033112582782, Recall: 0.11857707509881422, fitted: 4, true: 7
Precision: 0.11504424778761062, Recall: 0.0948905109489051, fitted: 5, true: 1
Precision: 0.11085450346420324, Recall: 0.096579476861167, fitted: 6, true: 8
Precision: 0.11682242990654206, Recall: 0.10141987829614604, fitted: 7, true: 6
Precision: 0.12030075187969924, Recall: 0.096, fitted: 8, true: 9
Precision: 0.12742382271468145, Recall: 0.09108910891089109, fitted: 9, true: 0
Precision: 0.1206896551724138, Recall: 0.07664233576642336, fitted: 10, true: 1
Precision: 0.17098445595854922, Recall: 0.060218978102189784, fitted: 11, true: 1
The current ACC is :0.3013142857142857
Iteration: 11-0, ELBO: -777423.5625
Iteration: 11-1, ELBO: -762825.4375
Iteration: 11-2, ELBO: -749223.25
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.1012 0.1088 0.0944 0.1    0.0998 0.0942 0.102  0.1012 0.0984 0.1   ]
The cluster evaluation result is 

NMI => 0.004110502343416695
ARS => -5.13373770517088e-05
HS => 0.00425142579980892
CS => 0.003974250124744866
VM => 0.004108168050919342
Precision: 0.1198501872659176, Recall: 0.11764705882352941, fitted: 0, true: 1
Precision: 0.12, Recall: 0.11264822134387352, fitted: 1, true: 0
Precision: 0.12311015118790497, Recall: 0.11264822134387352, fitted: 2, true: 7
Precision: 0.12147505422993492, Recall: 0.112, fitted: 3, true: 9
Precision: 0.12582781456953643, Recall: 0.11264822134387352, fitted: 4, true: 0
Precision: 0.11504424778761062, Recall: 0.09558823529411764, fitted: 5, true: 1
Precision: 0.12471131639722864, Recall: 0.09926470588235294, fitted: 6, true: 1
Precision: 0.12850467289719625, Recall: 0.11178861788617886, fitted: 7, true: 8
Precision: 0.12531328320802004, Recall: 0.1, fitted: 8, true: 9
Precision: 0.11634349030470914, Recall: 0.084, fitted: 9, true: 3
Precision: 0.13218390804597702, Recall: 0.09218436873747494, fitted: 10, true: 4
Precision: 0.12435233160621761, Recall: 0.047058823529411764, fitted: 11, true: 6
The current ACC is :0.3174
Iteration: 12-0, ELBO: -741965.5625
Iteration: 12-1, ELBO: -728545.9375
Iteration: 12-2, ELBO: -716103.25
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0968 0.121  0.098  0.1096 0.1056 0.0824 0.0964 0.107  0.0904 0.0928]
The cluster evaluation result is 

NMI => 0.0038216515316876034
ARS => -8.64335706718405e-05
HS => 0.003956694994351863
CS => 0.0036912171523199805
VM => 0.003819348378892114
Precision: 0.149812734082397, Recall: 0.1322314049586777, fitted: 0, true: 1
Precision: 0.11789473684210526, Recall: 0.11618257261410789, fitted: 1, true: 6
Precision: 0.11447084233261338, Recall: 0.10037878787878787, fitted: 2, true: 4
Precision: 0.1279826464208243, Recall: 0.09752066115702479, fitted: 3, true: 1
Precision: 0.1346578366445916, Recall: 0.10082644628099173, fitted: 4, true: 1
Precision: 0.12389380530973451, Recall: 0.09256198347107437, fitted: 5, true: 1
Precision: 0.12933025404157045, Recall: 0.10218978102189781, fitted: 6, true: 3
Precision: 0.12383177570093458, Recall: 0.10037878787878787, fitted: 7, true: 4
Precision: 0.13784461152882205, Recall: 0.102803738317757, fitted: 8, true: 7
Precision: 0.12465373961218837, Recall: 0.08211678832116788, fitted: 9, true: 3
Precision: 0.11781609195402298, Recall: 0.08471074380165289, fitted: 10, true: 0
Precision: 0.12435233160621761, Recall: 0.03966942148760331, fitted: 11, true: 1
The current ACC is :0.3325
Iteration: 13-0, ELBO: -701009.875
Iteration: 13-1, ELBO: -689182.25
Iteration: 13-2, ELBO: -677999.5625
The current epoch is epoch: 1
WARNING: Found unrecognized keyword args. These are ignored.
  --gamma1
Dataset Summary:
X Data
  total size: 5000 units
  batch size: 1000 units
  num. batches: 5
Allocation Model:  DP mixture with K=0. Concentration gamma0= 5.00
Obs. Data  Model:  Gaussian with full covariance.
Obs. Data  Prior:  Gauss-Wishart on mean and covar of each cluster
  E[  mean[k] ] = 
   [0. 0.]  ...
  E[ covar[k] ] = 
  [[0.1 0. ]
   [0.  0.1]] ...
Initialization:
  initname = /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
  K = 1 (number of clusters)
  seed = 1607680
  elapsed_time: 0.0 sec
Learn Alg: memoVB | task  1/1 | alg. seed: 1607680 | data order seed: 8541952
task_output_path: /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
MERGE @ lap 1.00: Disabled. Cannot plan merge on first lap. Need valid SS that represent whole dataset.
    0.200/300 after      0 sec. |   1609.7 MiB | K   12 | loss  2.095335881e+00 |  
    0.400/300 after      0 sec. |   1609.7 MiB | K   12 | loss  1.865456931e+00 |  
    0.600/300 after      0 sec. |   1609.7 MiB | K   12 | loss  1.752368533e+00 |  
    1.000/300 after      0 sec. |   1609.7 MiB | K   12 | loss  1.635303757e+00 |  
MERGE @ lap 2.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    2.000/300 after      0 sec. |   1609.7 MiB | K   24 | loss  1.272477879e+00 | Ndiff  204.931 
MERGE @ lap 3.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    3.000/300 after      1 sec. |   1609.7 MiB | K   24 | loss  1.219803929e+00 | Ndiff   91.860 
MERGE @ lap 4.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    4.000/300 after      1 sec. |   1609.7 MiB | K   24 | loss  1.207320122e+00 | Ndiff   39.052 
MERGE @ lap 5.00 : 6/40 accepted. Ndiff 258.25. 20 skipped.
    5.000/300 after      1 sec. |   1609.7 MiB | K   18 | loss  1.197857846e+00 | Ndiff    9.566 
MERGE @ lap 6.00 : 2/40 accepted. Ndiff 6.00. 2 skipped.
    6.000/300 after      1 sec. |   1609.7 MiB | K   16 | loss  1.193993412e+00 | Ndiff    6.932 
MERGE @ lap 7.00 : 1/37 accepted. Ndiff 0.00. 0 skipped.
    7.000/300 after      2 sec. |   1609.7 MiB | K   15 | loss  1.191285838e+00 | Ndiff    5.524 
MERGE @ lap 8.00 : 0/32 accepted. Ndiff 0.00. 0 skipped.
    8.000/300 after      2 sec. |   1609.7 MiB | K   15 | loss  1.190557029e+00 | Ndiff    9.087 
MERGE @ lap 9.00 : 1/30 accepted. Ndiff 40.37. 1 skipped.
    9.000/300 after      2 sec. |   1609.7 MiB | K   14 | loss  1.189729321e+00 | Ndiff    3.717 
MERGE @ lap 10.00 : 0/27 accepted. Ndiff 0.00. 0 skipped.
   10.000/300 after      2 sec. |   1609.7 MiB | K   14 | loss  1.186530981e+00 | Ndiff    9.590 
MERGE @ lap 11.00 : 1/29 accepted. Ndiff 25.71. 1 skipped.
   11.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.184690644e+00 | Ndiff    5.029 
MERGE @ lap 12.00 : 0/28 accepted. Ndiff 0.00. 0 skipped.
   12.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.182956337e+00 | Ndiff    4.764 
MERGE @ lap 13.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   13.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.182243270e+00 | Ndiff    4.812 
MERGE @ lap 14.00 : 0/17 accepted. Ndiff 0.00. 0 skipped.
   14.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.181054725e+00 | Ndiff    8.453 
MERGE @ lap 15.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   15.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.178696146e+00 | Ndiff    9.501 
MERGE @ lap 16.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   16.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.176375927e+00 | Ndiff    9.801 
MERGE @ lap 17.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   17.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.174801665e+00 | Ndiff    8.192 
MERGE @ lap 18.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   18.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.173630047e+00 | Ndiff    4.753 
MERGE @ lap 19.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   19.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.173000162e+00 | Ndiff    3.289 
MERGE @ lap 20.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   20.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.172748599e+00 | Ndiff    2.128 
MERGE @ lap 21.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   21.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.172695844e+00 | Ndiff    0.809 
MERGE @ lap 22.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   22.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.172682647e+00 | Ndiff    0.425 
MERGE @ lap 23.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   23.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.172677015e+00 | Ndiff    0.289 
MERGE @ lap 24.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   24.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.172673508e+00 | Ndiff    0.184 
MERGE @ lap 25.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   25.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.172670910e+00 | Ndiff    0.208 
MERGE @ lap 26.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   26.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.172668855e+00 | Ndiff    0.178 
MERGE @ lap 27.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   27.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.172667116e+00 | Ndiff    0.161 
MERGE @ lap 28.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   28.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.172665278e+00 | Ndiff    0.160 
MERGE @ lap 29.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   29.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.172661572e+00 | Ndiff    0.201 
MERGE @ lap 30.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   30.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.172646883e+00 | Ndiff    0.327 
MERGE @ lap 31.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   31.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.172607542e+00 | Ndiff    0.442 
MERGE @ lap 32.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   32.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.172597181e+00 | Ndiff    0.127 
MERGE @ lap 33.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   33.000/300 after      5 sec. |   1609.7 MiB | K   13 | loss  1.172595265e+00 | Ndiff    0.094 
MERGE @ lap 34.00 : 0/4 accepted. Ndiff 0.00. 0 skipped.
   34.000/300 after      5 sec. |   1609.7 MiB | K   13 | loss  1.172594594e+00 | Ndiff    0.057 
MERGE @ lap 35.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   35.000/300 after      5 sec. |   1609.7 MiB | K   13 | loss  1.172594266e+00 | Ndiff    0.048 
MERGE @ lap 36.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   36.000/300 after      5 sec. |   1609.7 MiB | K   13 | loss  1.172594088e+00 | Ndiff    0.030 
MERGE @ lap 37.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   37.000/300 after      5 sec. |   1609.7 MiB | K   13 | loss  1.172593975e+00 | Ndiff    0.024 
MERGE @ lap 38.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   38.000/300 after      5 sec. |   1609.7 MiB | K   13 | loss  1.172593898e+00 | Ndiff    0.019 
MERGE @ lap 39.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   39.000/300 after      5 sec. |   1609.7 MiB | K   13 | loss  1.172593836e+00 | Ndiff    0.017 
MERGE @ lap 40.00 : 0/4 accepted. Ndiff 0.00. 0 skipped.
   40.000/300 after      5 sec. |   1609.7 MiB | K   13 | loss  1.172593776e+00 | Ndiff    0.020 
MERGE @ lap 41.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   41.000/300 after      6 sec. |   1609.7 MiB | K   13 | loss  1.172593709e+00 | Ndiff    0.022 
MERGE @ lap 42.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   42.000/300 after      6 sec. |   1609.7 MiB | K   13 | loss  1.172593630e+00 | Ndiff    0.021 
MERGE @ lap 43.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   43.000/300 after      6 sec. |   1609.7 MiB | K   13 | loss  1.172593525e+00 | Ndiff    0.031 
MERGE @ lap 44.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   44.000/300 after      6 sec. |   1609.7 MiB | K   13 | loss  1.172593374e+00 | Ndiff    0.031 
MERGE @ lap 45.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   45.000/300 after      6 sec. |   1609.7 MiB | K   13 | loss  1.172593139e+00 | Ndiff    0.047 
MERGE @ lap 46.00 : 0/4 accepted. Ndiff 0.00. 0 skipped.
   46.000/300 after      6 sec. |   1609.7 MiB | K   13 | loss  1.172592755e+00 | Ndiff    0.053 
MERGE @ lap 47.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   47.000/300 after      6 sec. |   1609.7 MiB | K   13 | loss  1.172592097e+00 | Ndiff    0.081 
MERGE @ lap 48.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   48.000/300 after      6 sec. |   1609.7 MiB | K   13 | loss  1.172591021e+00 | Ndiff    0.083 
MERGE @ lap 49.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   49.000/300 after      6 sec. |   1609.7 MiB | K   13 | loss  1.172589524e+00 | Ndiff    0.098 
MERGE @ lap 50.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   50.000/300 after      7 sec. |   1609.7 MiB | K   13 | loss  1.172588086e+00 | Ndiff    0.084 
MERGE @ lap 51.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   51.000/300 after      7 sec. |   1609.7 MiB | K   13 | loss  1.172587304e+00 | Ndiff    0.054 
MERGE @ lap 52.00 : 0/4 accepted. Ndiff 0.00. 0 skipped.
   52.000/300 after      7 sec. |   1609.7 MiB | K   13 | loss  1.172586969e+00 | Ndiff    0.047 
MERGE @ lap 53.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   53.000/300 after      7 sec. |   1609.7 MiB | K   13 | loss  1.172586836e+00 | Ndiff    0.046 
MERGE @ lap 54.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   54.000/300 after      7 sec. |   1609.7 MiB | K   13 | loss  1.172586784e+00 | Ndiff    0.031 
MERGE @ lap 55.00 : 0/13 accepted. Ndiff 0.00. 0 skipped.
   55.000/300 after      7 sec. |   1609.7 MiB | K   13 | loss  1.172586760e+00 | Ndiff    0.026 
MERGE @ lap 56.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   56.000/300 after      7 sec. |   1609.7 MiB | K   13 | loss  1.172586748e+00 | Ndiff    0.019 
MERGE @ lap 57.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   57.000/300 after      7 sec. |   1609.7 MiB | K   13 | loss  1.172586742e+00 | Ndiff    0.015 
MERGE @ lap 58.00 : 0/4 accepted. Ndiff 0.00. 0 skipped.
   58.000/300 after      7 sec. |   1609.7 MiB | K   13 | loss  1.172586739e+00 | Ndiff    0.012 
MERGE @ lap 59.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   59.000/300 after      8 sec. |   1609.7 MiB | K   13 | loss  1.172586737e+00 | Ndiff    0.009 
MERGE @ lap 60.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   60.000/300 after      8 sec. |   1609.7 MiB | K   13 | loss  1.172586736e+00 | Ndiff    0.008 
... done. converged.
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0974 0.1126 0.0958 0.1068 0.1028 0.087  0.0972 0.1064 0.0992 0.0948]
The cluster evaluation result is 

NMI => 0.866036023569212
ARS => 0.8457612138751831
HS => 0.9024765473553084
CS => 0.831066908406084
VM => 0.8653009437137602
Precision: 0.9630390143737166, Recall: 0.9455645161290323, fitted: 0, true: 8
Precision: 0.9690721649484536, Recall: 0.9670781893004116, fitted: 1, true: 6
Precision: 0.9813278008298755, Recall: 0.971252566735113, fitted: 2, true: 0
Precision: 0.9560669456066946, Recall: 0.954070981210856, fitted: 3, true: 2
Precision: 0.9978768577494692, Recall: 0.8834586466165414, fitted: 4, true: 7
Precision: 0.9806034482758621, Recall: 0.8852140077821011, fitted: 5, true: 4
Precision: 0.9888143176733781, Recall: 0.8277153558052435, fitted: 6, true: 3
Precision: 0.9431818181818182, Recall: 0.9540229885057471, fitted: 7, true: 5
Precision: 0.9786729857819905, Recall: 0.8713080168776371, fitted: 8, true: 9
Precision: 0.9931506849315068, Recall: 0.5150976909413855, fitted: 9, true: 1
Precision: 0.9920634920634921, Recall: 0.44404973357015987, fitted: 10, true: 1
Precision: 0.41798941798941797, Recall: 0.14794007490636704, fitted: 11, true: 3
Precision: 0.5054945054945055, Recall: 0.08949416342412451, fitted: 12, true: 4
The current ACC is :0.9398142857142857
The current epoch is epoch: 2
WARNING: Found unrecognized keyword args. These are ignored.
  --gamma1
Dataset Summary:
X Data
  total size: 5000 units
  batch size: 1000 units
  num. batches: 5
Allocation Model:  DP mixture with K=0. Concentration gamma0= 5.00
Obs. Data  Model:  Gaussian with full covariance.
Obs. Data  Prior:  Gauss-Wishart on mean and covar of each cluster
  E[  mean[k] ] = 
   [0. 0.]  ...
  E[ covar[k] ] = 
  [[0.1 0. ]
   [0.  0.1]] ...
Initialization:
  initname = /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
  K = 1 (number of clusters)
  seed = 1607680
  elapsed_time: 0.0 sec
Learn Alg: memoVB | task  1/1 | alg. seed: 1607680 | data order seed: 8541952
task_output_path: /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
MERGE @ lap 1.00: Disabled. Cannot plan merge on first lap. Need valid SS that represent whole dataset.
    0.200/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.427012644e+00 |  
    0.400/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.267086430e+00 |  
    0.600/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.216121837e+00 |  
    1.000/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.176958394e+00 |  
MERGE @ lap 2.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    2.000/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.173065681e+00 | Ndiff   11.081 
MERGE @ lap 3.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    3.000/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.172559679e+00 | Ndiff    4.505 
MERGE @ lap 4.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    4.000/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.172347446e+00 | Ndiff    2.741 
MERGE @ lap 5.00 : 0/30 accepted. Ndiff 0.00. 0 skipped.
    5.000/300 after      1 sec. |   1609.7 MiB | K   13 | loss  1.172123028e+00 | Ndiff    1.661 
MERGE @ lap 6.00 : 0/28 accepted. Ndiff 0.00. 0 skipped.
    6.000/300 after      1 sec. |   1609.7 MiB | K   13 | loss  1.172013860e+00 | Ndiff    1.247 
MERGE @ lap 7.00 : 0/15 accepted. Ndiff 0.00. 0 skipped.
    7.000/300 after      1 sec. |   1609.7 MiB | K   13 | loss  1.171928251e+00 | Ndiff    1.174 
MERGE @ lap 8.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
    8.000/300 after      1 sec. |   1609.7 MiB | K   13 | loss  1.171855554e+00 | Ndiff    0.825 
MERGE @ lap 9.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
    9.000/300 after      1 sec. |   1609.7 MiB | K   13 | loss  1.171776734e+00 | Ndiff    0.947 
MERGE @ lap 10.00 : 0/6 accepted. Ndiff 0.00. 0 skipped.
   10.000/300 after      1 sec. |   1609.7 MiB | K   13 | loss  1.171690049e+00 | Ndiff    0.814 
MERGE @ lap 11.00 : 0/27 accepted. Ndiff 0.00. 0 skipped.
   11.000/300 after      1 sec. |   1609.7 MiB | K   13 | loss  1.171668203e+00 | Ndiff    0.490 
MERGE @ lap 12.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   12.000/300 after      1 sec. |   1609.7 MiB | K   13 | loss  1.171658528e+00 | Ndiff    0.234 
MERGE @ lap 13.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   13.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.171652904e+00 | Ndiff    0.184 
MERGE @ lap 14.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   14.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.171649127e+00 | Ndiff    0.179 
MERGE @ lap 15.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   15.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.171646306e+00 | Ndiff    0.140 
MERGE @ lap 16.00 : 0/1 accepted. Ndiff 0.00. 0 skipped.
   16.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.171644214e+00 | Ndiff    0.105 
MERGE @ lap 17.00 : 0/27 accepted. Ndiff 0.00. 0 skipped.
   17.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.171642838e+00 | Ndiff    0.105 
MERGE @ lap 18.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   18.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.171642022e+00 | Ndiff    0.075 
MERGE @ lap 19.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   19.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.171641564e+00 | Ndiff    0.052 
MERGE @ lap 20.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   20.000/300 after      2 sec. |   1609.7 MiB | K   13 | loss  1.171641277e+00 | Ndiff    0.051 
MERGE @ lap 21.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   21.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.171641043e+00 | Ndiff    0.063 
MERGE @ lap 22.00 : 0/1 accepted. Ndiff 0.00. 0 skipped.
   22.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.171640796e+00 | Ndiff    0.070 
MERGE @ lap 23.00 : 0/27 accepted. Ndiff 0.00. 0 skipped.
   23.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.171640513e+00 | Ndiff    0.064 
MERGE @ lap 24.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   24.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.171640171e+00 | Ndiff    0.089 
MERGE @ lap 25.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   25.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.171639771e+00 | Ndiff    0.077 
MERGE @ lap 26.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   26.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.171639333e+00 | Ndiff    0.089 
MERGE @ lap 27.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   27.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.171638907e+00 | Ndiff    0.086 
MERGE @ lap 28.00 : 0/1 accepted. Ndiff 0.00. 0 skipped.
   28.000/300 after      3 sec. |   1609.7 MiB | K   13 | loss  1.171638574e+00 | Ndiff    0.085 
MERGE @ lap 29.00 : 0/27 accepted. Ndiff 0.00. 0 skipped.
   29.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.171638345e+00 | Ndiff    0.061 
MERGE @ lap 30.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   30.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.171638212e+00 | Ndiff    0.054 
MERGE @ lap 31.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   31.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.171638138e+00 | Ndiff    0.034 
MERGE @ lap 32.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   32.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.171638101e+00 | Ndiff    0.029 
MERGE @ lap 33.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   33.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.171638083e+00 | Ndiff    0.020 
MERGE @ lap 34.00 : 0/1 accepted. Ndiff 0.00. 0 skipped.
   34.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.171638073e+00 | Ndiff    0.014 
MERGE @ lap 35.00 : 0/27 accepted. Ndiff 0.00. 0 skipped.
   35.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.171638067e+00 | Ndiff    0.011 
MERGE @ lap 36.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   36.000/300 after      4 sec. |   1609.7 MiB | K   13 | loss  1.171638065e+00 | Ndiff    0.005 
MERGE @ lap 37.00 : 0/14 accepted. Ndiff 0.00. 0 skipped.
   37.000/300 after      5 sec. |   1609.7 MiB | K   13 | loss  1.171638063e+00 | Ndiff    0.005 
... done. converged.
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0954 0.1162 0.0916 0.104  0.1004 0.0896 0.0972 0.1114 0.098  0.0962]
The cluster evaluation result is 

NMI => 0.8691047737799125
ARS => 0.8488682046281556
HS => 0.9063409280345127
CS => 0.8333984314766263
VM => 0.8683405404120783
Precision: 0.9868173258003766, Recall: 0.940754039497307, fitted: 0, true: 7
Precision: 0.979381443298969, Recall: 0.977366255144033, fitted: 1, true: 6
Precision: 0.9427966101694916, Recall: 0.9081632653061225, fitted: 2, true: 8
Precision: 0.9850427350427351, Recall: 0.9664570230607966, fitted: 3, true: 0
Precision: 0.9525862068965517, Recall: 0.9650655021834061, fitted: 4, true: 2
Precision: 0.9823788546255506, Recall: 0.8884462151394422, fitted: 5, true: 4
Precision: 0.9977628635346756, Recall: 0.8576923076923076, fitted: 6, true: 3
Precision: 0.9836829836829837, Recall: 0.9419642857142857, fitted: 7, true: 5
Precision: 0.9780487804878049, Recall: 0.8336798336798337, fitted: 8, true: 9
Precision: 1.0, Recall: 0.5559380378657487, fitted: 9, true: 1
Precision: 0.9954128440366973, Recall: 0.37349397590361444, fitted: 10, true: 1
Precision: 0.3172043010752688, Recall: 0.11346153846153846, fitted: 11, true: 3
Precision: 0.4336283185840708, Recall: 0.09760956175298804, fitted: 12, true: 4
The current ACC is :0.9400571428571428
The current epoch is epoch: 3
WARNING: Found unrecognized keyword args. These are ignored.
  --gamma1
Dataset Summary:
X Data
  total size: 5000 units
  batch size: 1000 units
  num. batches: 5
Allocation Model:  DP mixture with K=0. Concentration gamma0= 5.00
Obs. Data  Model:  Gaussian with full covariance.
Obs. Data  Prior:  Gauss-Wishart on mean and covar of each cluster
  E[  mean[k] ] = 
   [0. 0.]  ...
  E[ covar[k] ] = 
  [[0.1 0. ]
   [0.  0.1]] ...
Initialization:
  initname = /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
  K = 1 (number of clusters)
  seed = 1607680
  elapsed_time: 0.0 sec
Learn Alg: memoVB | task  1/1 | alg. seed: 1607680 | data order seed: 8541952
task_output_path: /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
MERGE @ lap 1.00: Disabled. Cannot plan merge on first lap. Need valid SS that represent whole dataset.
    0.200/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.409692742e+00 |  
    0.400/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.264624432e+00 |  
    0.600/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.214253463e+00 |  
    1.000/300 after      0 sec. |   1609.7 MiB | K   13 | loss  1.169328852e+00 |  
MERGE @ lap 2.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    2.000/300 after      0 sec. |   1609.9 MiB | K   13 | loss  1.167431806e+00 | Ndiff    3.826 
MERGE @ lap 3.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    3.000/300 after      0 sec. |   1609.9 MiB | K   13 | loss  1.167098555e+00 | Ndiff    1.759 
MERGE @ lap 4.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    4.000/300 after      0 sec. |   1609.9 MiB | K   13 | loss  1.166943838e+00 | Ndiff    1.439 
MERGE @ lap 5.00 : 0/30 accepted. Ndiff 0.00. 0 skipped.
    5.000/300 after      1 sec. |   1609.9 MiB | K   13 | loss  1.166830650e+00 | Ndiff    0.949 
MERGE @ lap 6.00 : 0/28 accepted. Ndiff 0.00. 0 skipped.
    6.000/300 after      1 sec. |   1609.9 MiB | K   13 | loss  1.166765828e+00 | Ndiff    0.798 
MERGE @ lap 7.00 : 0/15 accepted. Ndiff 0.00. 0 skipped.
    7.000/300 after      1 sec. |   1609.9 MiB | K   13 | loss  1.166723641e+00 | Ndiff    0.684 
MERGE @ lap 8.00 : 0/12 accepted. Ndiff 0.00. 0 skipped.
    8.000/300 after      1 sec. |   1609.9 MiB | K   13 | loss  1.166694778e+00 | Ndiff    0.612 
MERGE @ lap 9.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
    9.000/300 after      1 sec. |   1609.9 MiB | K   13 | loss  1.166681146e+00 | Ndiff    0.493 
MERGE @ lap 10.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   10.000/300 after      1 sec. |   1609.9 MiB | K   13 | loss  1.166673785e+00 | Ndiff    0.504 
MERGE @ lap 11.00 : 0/25 accepted. Ndiff 0.00. 0 skipped.
   11.000/300 after      1 sec. |   1609.9 MiB | K   13 | loss  1.166666240e+00 | Ndiff    0.440 
MERGE @ lap 12.00 : 0/27 accepted. Ndiff 0.00. 0 skipped.
   12.000/300 after      2 sec. |   1609.9 MiB | K   13 | loss  1.166642991e+00 | Ndiff    0.655 
MERGE @ lap 13.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   13.000/300 after      2 sec. |   1609.9 MiB | K   13 | loss  1.166597693e+00 | Ndiff    0.943 
MERGE @ lap 14.00 : 0/12 accepted. Ndiff 0.00. 0 skipped.
   14.000/300 after      2 sec. |   1609.9 MiB | K   13 | loss  1.166582819e+00 | Ndiff    0.585 
MERGE @ lap 15.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   15.000/300 after      2 sec. |   1609.9 MiB | K   13 | loss  1.166576758e+00 | Ndiff    0.333 
MERGE @ lap 16.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   16.000/300 after      2 sec. |   1609.9 MiB | K   13 | loss  1.166573783e+00 | Ndiff    0.345 
MERGE @ lap 17.00 : 0/28 accepted. Ndiff 0.00. 0 skipped.
   17.000/300 after      2 sec. |   1609.9 MiB | K   13 | loss  1.166572514e+00 | Ndiff    0.183 
MERGE @ lap 18.00 : 0/24 accepted. Ndiff 0.00. 0 skipped.
   18.000/300 after      2 sec. |   1609.9 MiB | K   13 | loss  1.166571936e+00 | Ndiff    0.126 
MERGE @ lap 19.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   19.000/300 after      2 sec. |   1609.9 MiB | K   13 | loss  1.166571606e+00 | Ndiff    0.089 
MERGE @ lap 20.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   20.000/300 after      2 sec. |   1609.9 MiB | K   13 | loss  1.166571320e+00 | Ndiff    0.085 
MERGE @ lap 21.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   21.000/300 after      3 sec. |   1609.9 MiB | K   13 | loss  1.166570910e+00 | Ndiff    0.061 
MERGE @ lap 22.00: No promising candidates, so no attempts.
   22.000/300 after      3 sec. |   1609.9 MiB | K   13 | loss  1.166570065e+00 | Ndiff    0.093 
MERGE @ lap 23.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   23.000/300 after      3 sec. |   1609.9 MiB | K   13 | loss  1.166567721e+00 | Ndiff    0.177 
MERGE @ lap 24.00 : 0/24 accepted. Ndiff 0.00. 0 skipped.
   24.000/300 after      3 sec. |   1609.9 MiB | K   13 | loss  1.166559927e+00 | Ndiff    0.314 
MERGE @ lap 25.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   25.000/300 after      3 sec. |   1609.9 MiB | K   13 | loss  1.166538023e+00 | Ndiff    0.514 
MERGE @ lap 26.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   26.000/300 after      3 sec. |   1609.9 MiB | K   13 | loss  1.166512456e+00 | Ndiff    0.376 
MERGE @ lap 27.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   27.000/300 after      3 sec. |   1609.9 MiB | K   13 | loss  1.166508128e+00 | Ndiff    0.090 
MERGE @ lap 28.00: No promising candidates, so no attempts.
   28.000/300 after      3 sec. |   1609.9 MiB | K   13 | loss  1.166507264e+00 | Ndiff    0.065 
MERGE @ lap 29.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   29.000/300 after      4 sec. |   1609.9 MiB | K   13 | loss  1.166506895e+00 | Ndiff    0.055 
MERGE @ lap 30.00 : 0/24 accepted. Ndiff 0.00. 0 skipped.
   30.000/300 after      4 sec. |   1609.9 MiB | K   13 | loss  1.166506710e+00 | Ndiff    0.034 
MERGE @ lap 31.00 : 0/19 accepted. Ndiff 0.00. 0 skipped.
   31.000/300 after      4 sec. |   1609.9 MiB | K   13 | loss  1.166506605e+00 | Ndiff    0.024 
MERGE @ lap 32.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   32.000/300 after      4 sec. |   1609.9 MiB | K   13 | loss  1.166506546e+00 | Ndiff    0.021 
MERGE @ lap 33.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   33.000/300 after      4 sec. |   1609.9 MiB | K   13 | loss  1.166506512e+00 | Ndiff    0.016 
MERGE @ lap 34.00: No promising candidates, so no attempts.
   34.000/300 after      4 sec. |   1609.9 MiB | K   13 | loss  1.166506492e+00 | Ndiff    0.010 
MERGE @ lap 35.00 : 0/23 accepted. Ndiff 0.00. 0 skipped.
   35.000/300 after      4 sec. |   1609.9 MiB | K   13 | loss  1.166506479e+00 | Ndiff    0.009 
... done. converged.
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0988 0.1158 0.1036 0.0998 0.0942 0.084  0.1012 0.11   0.0938 0.0988]
The cluster evaluation result is 

NMI => 0.8721763110358988
ARS => 0.8550818622129772
HS => 0.9068369405966427
CS => 0.8388404612539282
VM => 0.8715144238285828
Precision: 0.9723247232472325, Recall: 0.9581818181818181, fitted: 0, true: 7
Precision: 0.9613899613899614, Recall: 0.9613899613899614, fitted: 1, true: 2
Precision: 0.96875, Recall: 0.9802371541501976, fitted: 2, true: 6
Precision: 0.9836734693877551, Recall: 0.9757085020242915, fitted: 3, true: 0
Precision: 0.9736842105263158, Recall: 0.8987854251012146, fitted: 4, true: 9
Precision: 0.984304932735426, Recall: 0.8797595190380761, fitted: 5, true: 3
Precision: 0.9652777777777778, Recall: 0.8891257995735607, fitted: 6, true: 8
Precision: 0.9463869463869464, Recall: 0.9666666666666667, fitted: 7, true: 5
Precision: 0.9900249376558603, Recall: 0.8428874734607219, fitted: 8, true: 4
Precision: 1.0, Recall: 0.5043177892918825, fitted: 9, true: 1
Precision: 0.9956709956709957, Recall: 0.39723661485319517, fitted: 10, true: 1
Precision: 0.2994011976047904, Recall: 0.08635578583765112, fitted: 11, true: 1
Precision: 0.6666666666666666, Recall: 0.11889596602972399, fitted: 12, true: 4
The current ACC is :0.9424857142857143
The current epoch is epoch: 4
WARNING: Found unrecognized keyword args. These are ignored.
  --gamma1
Dataset Summary:
X Data
  total size: 5000 units
  batch size: 1000 units
  num. batches: 5
Allocation Model:  DP mixture with K=0. Concentration gamma0= 5.00
Obs. Data  Model:  Gaussian with full covariance.
Obs. Data  Prior:  Gauss-Wishart on mean and covar of each cluster
  E[  mean[k] ] = 
   [0. 0.]  ...
  E[ covar[k] ] = 
  [[0.1 0. ]
   [0.  0.1]] ...
Initialization:
  initname = /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
  K = 1 (number of clusters)
  seed = 1607680
  elapsed_time: 0.0 sec
Learn Alg: memoVB | task  1/1 | alg. seed: 1607680 | data order seed: 8541952
task_output_path: /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
MERGE @ lap 1.00: Disabled. Cannot plan merge on first lap. Need valid SS that represent whole dataset.
    0.200/300 after      0 sec. |   1639.8 MiB | K   13 | loss  1.458262102e+00 |  
    0.400/300 after      0 sec. |   1639.8 MiB | K   13 | loss  1.293758222e+00 |  
    0.600/300 after      0 sec. |   1639.8 MiB | K   13 | loss  1.233811293e+00 |  
    1.000/300 after      0 sec. |   1639.8 MiB | K   13 | loss  1.187359812e+00 |  
MERGE @ lap 2.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    2.000/300 after      0 sec. |   1639.8 MiB | K   13 | loss  1.185006687e+00 | Ndiff    6.443 
MERGE @ lap 3.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    3.000/300 after      0 sec. |   1639.8 MiB | K   13 | loss  1.184465093e+00 | Ndiff    9.934 
MERGE @ lap 4.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    4.000/300 after      0 sec. |   1639.8 MiB | K   13 | loss  1.184145583e+00 | Ndiff    1.289 
MERGE @ lap 5.00 : 0/30 accepted. Ndiff 0.00. 0 skipped.
    5.000/300 after      1 sec. |   1639.8 MiB | K   13 | loss  1.184002743e+00 | Ndiff    1.147 
MERGE @ lap 6.00 : 0/28 accepted. Ndiff 0.00. 0 skipped.
    6.000/300 after      1 sec. |   1639.8 MiB | K   13 | loss  1.183876927e+00 | Ndiff    0.584 
MERGE @ lap 7.00 : 0/15 accepted. Ndiff 0.00. 0 skipped.
    7.000/300 after      1 sec. |   1639.8 MiB | K   13 | loss  1.183849717e+00 | Ndiff    0.404 
MERGE @ lap 8.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
    8.000/300 after      1 sec. |   1639.8 MiB | K   13 | loss  1.183834584e+00 | Ndiff    0.349 
MERGE @ lap 9.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
    9.000/300 after      1 sec. |   1639.8 MiB | K   13 | loss  1.183824818e+00 | Ndiff    0.220 
MERGE @ lap 10.00 : 0/2 accepted. Ndiff 0.00. 0 skipped.
   10.000/300 after      1 sec. |   1639.8 MiB | K   13 | loss  1.183819590e+00 | Ndiff    0.153 
MERGE @ lap 11.00 : 0/21 accepted. Ndiff 0.00. 0 skipped.
   11.000/300 after      1 sec. |   1639.8 MiB | K   13 | loss  1.183816810e+00 | Ndiff    0.163 
MERGE @ lap 12.00 : 0/25 accepted. Ndiff 0.00. 0 skipped.
   12.000/300 after      1 sec. |   1639.8 MiB | K   13 | loss  1.183814950e+00 | Ndiff    0.127 
MERGE @ lap 13.00 : 0/15 accepted. Ndiff 0.00. 0 skipped.
   13.000/300 after      2 sec. |   1639.8 MiB | K   13 | loss  1.183813372e+00 | Ndiff    0.148 
MERGE @ lap 14.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   14.000/300 after      2 sec. |   1639.8 MiB | K   13 | loss  1.183811854e+00 | Ndiff    0.122 
MERGE @ lap 15.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   15.000/300 after      2 sec. |   1639.8 MiB | K   13 | loss  1.183810417e+00 | Ndiff    0.121 
MERGE @ lap 16.00: No promising candidates, so no attempts.
   16.000/300 after      2 sec. |   1639.8 MiB | K   13 | loss  1.183809309e+00 | Ndiff    0.094 
MERGE @ lap 17.00 : 0/21 accepted. Ndiff 0.00. 0 skipped.
   17.000/300 after      2 sec. |   1639.8 MiB | K   13 | loss  1.183808602e+00 | Ndiff    0.065 
MERGE @ lap 18.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   18.000/300 after      2 sec. |   1639.8 MiB | K   13 | loss  1.183808089e+00 | Ndiff    0.067 
MERGE @ lap 19.00 : 0/15 accepted. Ndiff 0.00. 0 skipped.
   19.000/300 after      2 sec. |   1639.8 MiB | K   13 | loss  1.183807634e+00 | Ndiff    0.063 
MERGE @ lap 20.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   20.000/300 after      2 sec. |   1639.8 MiB | K   13 | loss  1.183807205e+00 | Ndiff    0.055 
MERGE @ lap 21.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   21.000/300 after      3 sec. |   1639.8 MiB | K   13 | loss  1.183806812e+00 | Ndiff    0.063 
MERGE @ lap 22.00: No promising candidates, so no attempts.
   22.000/300 after      3 sec. |   1639.8 MiB | K   13 | loss  1.183806479e+00 | Ndiff    0.053 
MERGE @ lap 23.00 : 0/21 accepted. Ndiff 0.00. 0 skipped.
   23.000/300 after      3 sec. |   1639.8 MiB | K   13 | loss  1.183806232e+00 | Ndiff    0.047 
MERGE @ lap 24.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   24.000/300 after      3 sec. |   1639.8 MiB | K   13 | loss  1.183806068e+00 | Ndiff    0.034 
MERGE @ lap 25.00 : 0/15 accepted. Ndiff 0.00. 0 skipped.
   25.000/300 after      3 sec. |   1639.8 MiB | K   13 | loss  1.183805970e+00 | Ndiff    0.041 
MERGE @ lap 26.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   26.000/300 after      3 sec. |   1639.8 MiB | K   13 | loss  1.183805913e+00 | Ndiff    0.029 
MERGE @ lap 27.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   27.000/300 after      3 sec. |   1639.8 MiB | K   13 | loss  1.183805880e+00 | Ndiff    0.015 
MERGE @ lap 28.00: No promising candidates, so no attempts.
   28.000/300 after      3 sec. |   1639.8 MiB | K   13 | loss  1.183805861e+00 | Ndiff    0.017 
MERGE @ lap 29.00 : 0/21 accepted. Ndiff 0.00. 0 skipped.
   29.000/300 after      4 sec. |   1639.8 MiB | K   13 | loss  1.183805849e+00 | Ndiff    0.015 
MERGE @ lap 30.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   30.000/300 after      4 sec. |   1639.8 MiB | K   13 | loss  1.183805841e+00 | Ndiff    0.016 
MERGE @ lap 31.00 : 0/15 accepted. Ndiff 0.00. 0 skipped.
   31.000/300 after      4 sec. |   1639.8 MiB | K   13 | loss  1.183805836e+00 | Ndiff    0.010 
MERGE @ lap 32.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   32.000/300 after      4 sec. |   1639.8 MiB | K   13 | loss  1.183805833e+00 | Ndiff    0.008 
... done. converged.
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0944 0.1062 0.1038 0.1066 0.0974 0.096  0.0968 0.1096 0.0934 0.0958]
The cluster evaluation result is 

NMI => 0.8752379878997226
ARS => 0.8670946233946172
HS => 0.9051468264096216
CS => 0.8463174295173245
VM => 0.8747441266591358
Precision: 0.9736842105263158, Recall: 0.9452554744525548, fitted: 0, true: 7
Precision: 0.963531669865643, Recall: 0.9672447013487476, fitted: 1, true: 2
Precision: 0.9817813765182186, Recall: 0.9099437148217636, fitted: 2, true: 3
Precision: 0.959349593495935, Recall: 0.9752066115702479, fitted: 3, true: 6
Precision: 0.9580712788259959, Recall: 0.9520833333333333, fitted: 4, true: 5
Precision: 0.9701492537313433, Recall: 0.9342915811088296, fitted: 5, true: 4
Precision: 0.9807692307692307, Recall: 0.972457627118644, fitted: 6, true: 0
Precision: 0.9616252821670429, Recall: 0.9122055674518201, fitted: 7, true: 8
Precision: 0.9836065573770492, Recall: 0.8768267223382046, fitted: 8, true: 9
Precision: 1.0, Recall: 0.512241054613936, fitted: 9, true: 1
Precision: 0.995049504950495, Recall: 0.3785310734463277, fitted: 10, true: 1
Precision: 0.3493975903614458, Recall: 0.10922787193973635, fitted: 11, true: 1
Precision: 0.5405405405405406, Recall: 0.04106776180698152, fitted: 12, true: 4
The current ACC is :0.9462857142857143
The current epoch is epoch: 5
WARNING: Found unrecognized keyword args. These are ignored.
  --gamma1
Dataset Summary:
X Data
  total size: 5000 units
  batch size: 1000 units
  num. batches: 5
Allocation Model:  DP mixture with K=0. Concentration gamma0= 5.00
Obs. Data  Model:  Gaussian with full covariance.
Obs. Data  Prior:  Gauss-Wishart on mean and covar of each cluster
  E[  mean[k] ] = 
   [0. 0.]  ...
  E[ covar[k] ] = 
  [[0.1 0. ]
   [0.  0.1]] ...
Initialization:
  initname = /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
  K = 1 (number of clusters)
  seed = 1607680
  elapsed_time: 0.0 sec
Learn Alg: memoVB | task  1/1 | alg. seed: 1607680 | data order seed: 8541952
task_output_path: /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
MERGE @ lap 1.00: Disabled. Cannot plan merge on first lap. Need valid SS that represent whole dataset.
    0.200/300 after      0 sec. |   1597.9 MiB | K   13 | loss  1.407200801e+00 |  
    0.400/300 after      0 sec. |   1597.9 MiB | K   13 | loss  1.263949422e+00 |  
    0.600/300 after      0 sec. |   1597.9 MiB | K   13 | loss  1.221786984e+00 |  
    1.000/300 after      0 sec. |   1597.9 MiB | K   13 | loss  1.181733985e+00 |  
MERGE @ lap 2.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    2.000/300 after      0 sec. |   1598.0 MiB | K   13 | loss  1.178247281e+00 | Ndiff    8.218 
MERGE @ lap 3.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    3.000/300 after      0 sec. |   1598.0 MiB | K   13 | loss  1.177712305e+00 | Ndiff    1.918 
MERGE @ lap 4.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    4.000/300 after      0 sec. |   1598.0 MiB | K   13 | loss  1.177567702e+00 | Ndiff    1.189 
MERGE @ lap 5.00 : 0/30 accepted. Ndiff 0.00. 0 skipped.
    5.000/300 after      1 sec. |   1598.0 MiB | K   13 | loss  1.177495390e+00 | Ndiff    0.949 
MERGE @ lap 6.00 : 0/28 accepted. Ndiff 0.00. 0 skipped.
    6.000/300 after      1 sec. |   1598.0 MiB | K   13 | loss  1.177448445e+00 | Ndiff    0.423 
MERGE @ lap 7.00 : 1/12 accepted. Ndiff 10.89. 3 skipped.
    7.000/300 after      1 sec. |   1598.0 MiB | K   12 | loss  1.176659457e+00 | Ndiff    0.423 
MERGE @ lap 8.00: No promising candidates, so no attempts.
    8.000/300 after      1 sec. |   1598.0 MiB | K   12 | loss  1.175523828e+00 | Ndiff    5.679 
MERGE @ lap 9.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
    9.000/300 after      1 sec. |   1598.0 MiB | K   12 | loss  1.175455647e+00 | Ndiff    1.001 
MERGE @ lap 10.00 : 0/2 accepted. Ndiff 0.00. 0 skipped.
   10.000/300 after      1 sec. |   1598.0 MiB | K   12 | loss  1.175444968e+00 | Ndiff    0.380 
MERGE @ lap 11.00 : 0/29 accepted. Ndiff 0.00. 0 skipped.
   11.000/300 after      1 sec. |   1598.0 MiB | K   12 | loss  1.175440251e+00 | Ndiff    0.258 
MERGE @ lap 12.00 : 0/21 accepted. Ndiff 0.00. 0 skipped.
   12.000/300 after      1 sec. |   1598.0 MiB | K   12 | loss  1.175436912e+00 | Ndiff    0.183 
MERGE @ lap 13.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   13.000/300 after      2 sec. |   1598.0 MiB | K   12 | loss  1.175434177e+00 | Ndiff    0.155 
MERGE @ lap 14.00: No promising candidates, so no attempts.
   14.000/300 after      2 sec. |   1598.0 MiB | K   12 | loss  1.175431870e+00 | Ndiff    0.178 
MERGE @ lap 15.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   15.000/300 after      2 sec. |   1598.0 MiB | K   12 | loss  1.175429983e+00 | Ndiff    0.173 
MERGE @ lap 16.00 : 0/2 accepted. Ndiff 0.00. 0 skipped.
   16.000/300 after      2 sec. |   1598.0 MiB | K   12 | loss  1.175428598e+00 | Ndiff    0.120 
MERGE @ lap 17.00 : 0/29 accepted. Ndiff 0.00. 0 skipped.
   17.000/300 after      2 sec. |   1598.0 MiB | K   12 | loss  1.175427663e+00 | Ndiff    0.100 
MERGE @ lap 18.00 : 0/21 accepted. Ndiff 0.00. 0 skipped.
   18.000/300 after      2 sec. |   1598.0 MiB | K   12 | loss  1.175426993e+00 | Ndiff    0.114 
MERGE @ lap 19.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   19.000/300 after      2 sec. |   1598.0 MiB | K   12 | loss  1.175426498e+00 | Ndiff    0.094 
MERGE @ lap 20.00: No promising candidates, so no attempts.
   20.000/300 after      2 sec. |   1598.0 MiB | K   12 | loss  1.175426139e+00 | Ndiff    0.065 
MERGE @ lap 21.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   21.000/300 after      2 sec. |   1598.0 MiB | K   12 | loss  1.175425877e+00 | Ndiff    0.084 
MERGE @ lap 22.00 : 0/2 accepted. Ndiff 0.00. 0 skipped.
   22.000/300 after      3 sec. |   1598.0 MiB | K   12 | loss  1.175425675e+00 | Ndiff    0.070 
MERGE @ lap 23.00 : 0/29 accepted. Ndiff 0.00. 0 skipped.
   23.000/300 after      3 sec. |   1598.0 MiB | K   12 | loss  1.175425526e+00 | Ndiff    0.050 
MERGE @ lap 24.00 : 0/21 accepted. Ndiff 0.00. 0 skipped.
   24.000/300 after      3 sec. |   1598.0 MiB | K   12 | loss  1.175425409e+00 | Ndiff    0.057 
MERGE @ lap 25.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   25.000/300 after      3 sec. |   1598.0 MiB | K   12 | loss  1.175425321e+00 | Ndiff    0.030 
MERGE @ lap 26.00: No promising candidates, so no attempts.
   26.000/300 after      3 sec. |   1598.0 MiB | K   12 | loss  1.175425256e+00 | Ndiff    0.031 
MERGE @ lap 27.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   27.000/300 after      3 sec. |   1598.0 MiB | K   12 | loss  1.175425206e+00 | Ndiff    0.030 
MERGE @ lap 28.00 : 0/2 accepted. Ndiff 0.00. 0 skipped.
   28.000/300 after      3 sec. |   1598.0 MiB | K   12 | loss  1.175425169e+00 | Ndiff    0.030 
MERGE @ lap 29.00 : 0/29 accepted. Ndiff 0.00. 0 skipped.
   29.000/300 after      3 sec. |   1598.0 MiB | K   12 | loss  1.175425141e+00 | Ndiff    0.021 
MERGE @ lap 30.00 : 0/21 accepted. Ndiff 0.00. 0 skipped.
   30.000/300 after      4 sec. |   1598.0 MiB | K   12 | loss  1.175425121e+00 | Ndiff    0.020 
MERGE @ lap 31.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
   31.000/300 after      4 sec. |   1598.0 MiB | K   12 | loss  1.175425104e+00 | Ndiff    0.018 
MERGE @ lap 32.00: No promising candidates, so no attempts.
   32.000/300 after      4 sec. |   1598.0 MiB | K   12 | loss  1.175425092e+00 | Ndiff    0.018 
MERGE @ lap 33.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   33.000/300 after      4 sec. |   1598.0 MiB | K   12 | loss  1.175425082e+00 | Ndiff    0.009 
... done. converged.
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.1028 0.1132 0.0984 0.1028 0.0984 0.084  0.1008 0.1026 0.098  0.099 ]
The cluster evaluation result is 

NMI => 0.8752149603831577
ARS => 0.8626695967863341
HS => 0.9029033025916547
CS => 0.84837570610252
VM => 0.8747906222545935
Precision: 0.9843444227005871, Recall: 0.9785992217898832, fitted: 0, true: 0
Precision: 0.9500998003992016, Recall: 0.967479674796748, fitted: 1, true: 4
Precision: 0.9878296146044625, Recall: 0.9662698412698413, fitted: 2, true: 6
Precision: 0.9776422764227642, Recall: 0.9357976653696498, fitted: 3, true: 3
Precision: 0.9854166666666667, Recall: 0.9220272904483431, fitted: 4, true: 7
Precision: 0.9786324786324786, Recall: 0.9308943089430894, fitted: 5, true: 2
Precision: 0.9568034557235421, Recall: 0.9040816326530612, fitted: 6, true: 8
Precision: 0.9685393258426966, Recall: 0.8707070707070707, fitted: 7, true: 9
Precision: 0.9754901960784313, Recall: 0.9476190476190476, fitted: 8, true: 5
Precision: 1.0, Recall: 0.5742049469964664, fitted: 9, true: 1
Precision: 0.21875, Recall: 0.08657243816254417, fitted: 10, true: 1
Precision: 0.9947368421052631, Recall: 0.3339222614840989, fitted: 11, true: 1
The current ACC is :0.9430142857142857
The current epoch is epoch: 6
WARNING: Found unrecognized keyword args. These are ignored.
  --gamma1
Dataset Summary:
X Data
  total size: 5000 units
  batch size: 1000 units
  num. batches: 5
Allocation Model:  DP mixture with K=0. Concentration gamma0= 5.00
Obs. Data  Model:  Gaussian with full covariance.
Obs. Data  Prior:  Gauss-Wishart on mean and covar of each cluster
  E[  mean[k] ] = 
   [0. 0.]  ...
  E[ covar[k] ] = 
  [[0.1 0. ]
   [0.  0.1]] ...
Initialization:
  initname = /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
  K = 1 (number of clusters)
  seed = 1607680
  elapsed_time: 0.0 sec
Learn Alg: memoVB | task  1/1 | alg. seed: 1607680 | data order seed: 8541952
task_output_path: /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
MERGE @ lap 1.00: Disabled. Cannot plan merge on first lap. Need valid SS that represent whole dataset.
    0.200/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.425443620e+00 |  
    0.400/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.272511929e+00 |  
    0.600/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.215898959e+00 |  
    1.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.171877988e+00 |  
MERGE @ lap 2.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    2.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.169242326e+00 | Ndiff    9.012 
MERGE @ lap 3.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    3.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.168769964e+00 | Ndiff    3.084 
MERGE @ lap 4.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    4.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.168656152e+00 | Ndiff    1.185 
MERGE @ lap 5.00 : 0/30 accepted. Ndiff 0.00. 0 skipped.
    5.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.168609589e+00 | Ndiff    0.506 
MERGE @ lap 6.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
    6.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.168569696e+00 | Ndiff    0.456 
MERGE @ lap 7.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
    7.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.168511033e+00 | Ndiff    1.059 
MERGE @ lap 8.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
    8.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.168405798e+00 | Ndiff    1.433 
MERGE @ lap 9.00 : 0/6 accepted. Ndiff 0.00. 0 skipped.
    9.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.168310718e+00 | Ndiff    0.879 
MERGE @ lap 10.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   10.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.168265189e+00 | Ndiff    0.757 
MERGE @ lap 11.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   11.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.168252939e+00 | Ndiff    0.293 
MERGE @ lap 12.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   12.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.168248106e+00 | Ndiff    0.185 
MERGE @ lap 13.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   13.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.168245083e+00 | Ndiff    0.123 
MERGE @ lap 14.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   14.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.168242189e+00 | Ndiff    0.124 
MERGE @ lap 15.00 : 0/6 accepted. Ndiff 0.00. 0 skipped.
   15.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.168238238e+00 | Ndiff    0.160 
MERGE @ lap 16.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   16.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.168231681e+00 | Ndiff    0.227 
MERGE @ lap 17.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   17.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.168223427e+00 | Ndiff    0.208 
MERGE @ lap 18.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   18.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.168217886e+00 | Ndiff    0.152 
MERGE @ lap 19.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   19.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.168214709e+00 | Ndiff    0.197 
MERGE @ lap 20.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   20.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.168213075e+00 | Ndiff    0.137 
MERGE @ lap 21.00 : 0/6 accepted. Ndiff 0.00. 0 skipped.
   21.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.168212420e+00 | Ndiff    0.085 
MERGE @ lap 22.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   22.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.168212135e+00 | Ndiff    0.037 
MERGE @ lap 23.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   23.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.168211981e+00 | Ndiff    0.027 
MERGE @ lap 24.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   24.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.168211886e+00 | Ndiff    0.023 
MERGE @ lap 25.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   25.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.168211825e+00 | Ndiff    0.020 
MERGE @ lap 26.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   26.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.168211785e+00 | Ndiff    0.018 
MERGE @ lap 27.00 : 0/6 accepted. Ndiff 0.00. 0 skipped.
   27.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.168211758e+00 | Ndiff    0.014 
MERGE @ lap 28.00 : 0/7 accepted. Ndiff 0.00. 0 skipped.
   28.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.168211739e+00 | Ndiff    0.011 
MERGE @ lap 29.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   29.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.168211727e+00 | Ndiff    0.011 
MERGE @ lap 30.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   30.000/300 after      4 sec. |   1612.7 MiB | K   12 | loss  1.168211718e+00 | Ndiff    0.008 
MERGE @ lap 31.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   31.000/300 after      4 sec. |   1612.7 MiB | K   12 | loss  1.168211712e+00 | Ndiff    0.006 
... done. converged.
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.1002 0.1144 0.0962 0.1056 0.0972 0.0868 0.1026 0.1008 0.094  0.1022]
The cluster evaluation result is 

NMI => 0.8798432266545321
ARS => 0.8687207041457709
HS => 0.9067035718645731
CS => 0.8537785970093021
VM => 0.8794455486987873
Precision: 0.9824561403508771, Recall: 0.9824561403508771, fitted: 0, true: 6
Precision: 0.974559686888454, Recall: 0.9431818181818182, fitted: 1, true: 3
Precision: 0.9433198380566802, Recall: 0.9688149688149689, fitted: 2, true: 2
Precision: 0.9815195071868583, Recall: 0.9484126984126984, fitted: 3, true: 7
Precision: 0.9958592132505176, Recall: 0.9600798403193613, fitted: 4, true: 0
Precision: 0.9686847599164927, Recall: 0.9547325102880658, fitted: 5, true: 4
Precision: 0.9782135076252724, Recall: 0.8786692759295499, fitted: 6, true: 9
Precision: 0.9545454545454546, Recall: 0.8936170212765957, fitted: 7, true: 8
Precision: 0.9604651162790697, Recall: 0.9516129032258065, fitted: 8, true: 5
Precision: 1.0, Recall: 0.5646853146853147, fitted: 9, true: 1
Precision: 1.0, Recall: 0.33916083916083917, fitted: 10, true: 1
Precision: 0.25133689839572193, Recall: 0.08216783216783216, fitted: 11, true: 1
The current ACC is :0.9431571428571428
The current epoch is epoch: 7
WARNING: Found unrecognized keyword args. These are ignored.
  --gamma1
Dataset Summary:
X Data
  total size: 5000 units
  batch size: 1000 units
  num. batches: 5
Allocation Model:  DP mixture with K=0. Concentration gamma0= 5.00
Obs. Data  Model:  Gaussian with full covariance.
Obs. Data  Prior:  Gauss-Wishart on mean and covar of each cluster
  E[  mean[k] ] = 
   [0. 0.]  ...
  E[ covar[k] ] = 
  [[0.1 0. ]
   [0.  0.1]] ...
Initialization:
  initname = /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
  K = 1 (number of clusters)
  seed = 1607680
  elapsed_time: 0.0 sec
Learn Alg: memoVB | task  1/1 | alg. seed: 1607680 | data order seed: 8541952
task_output_path: /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
MERGE @ lap 1.00: Disabled. Cannot plan merge on first lap. Need valid SS that represent whole dataset.
    0.200/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.405415056e+00 |  
    0.400/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.267351972e+00 |  
    0.600/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.213076808e+00 |  
    1.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.169451513e+00 |  
MERGE @ lap 2.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    2.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.166813046e+00 | Ndiff    8.439 
MERGE @ lap 3.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    3.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.166286904e+00 | Ndiff    2.341 
MERGE @ lap 4.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    4.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.166060759e+00 | Ndiff    0.998 
MERGE @ lap 5.00 : 0/30 accepted. Ndiff 0.00. 0 skipped.
    5.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.165895556e+00 | Ndiff    1.603 
MERGE @ lap 6.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
    6.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.165787048e+00 | Ndiff    1.174 
MERGE @ lap 7.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
    7.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.165730238e+00 | Ndiff    1.003 
MERGE @ lap 8.00 : 0/9 accepted. Ndiff 0.00. 0 skipped.
    8.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.165689683e+00 | Ndiff    0.774 
MERGE @ lap 9.00 : 0/6 accepted. Ndiff 0.00. 0 skipped.
    9.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.165665671e+00 | Ndiff    0.567 
MERGE @ lap 10.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   10.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.165651798e+00 | Ndiff    0.518 
MERGE @ lap 11.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   11.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.165644384e+00 | Ndiff    0.350 
MERGE @ lap 12.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   12.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.165640944e+00 | Ndiff    0.225 
MERGE @ lap 13.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   13.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.165639292e+00 | Ndiff    0.152 
MERGE @ lap 14.00 : 0/1 accepted. Ndiff 0.00. 0 skipped.
   14.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.165638409e+00 | Ndiff    0.112 
MERGE @ lap 15.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   15.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.165637893e+00 | Ndiff    0.076 
MERGE @ lap 16.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   16.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.165637580e+00 | Ndiff    0.051 
MERGE @ lap 17.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   17.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.165637382e+00 | Ndiff    0.049 
MERGE @ lap 18.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   18.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.165637241e+00 | Ndiff    0.037 
MERGE @ lap 19.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   19.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.165637130e+00 | Ndiff    0.033 
MERGE @ lap 20.00 : 0/1 accepted. Ndiff 0.00. 0 skipped.
   20.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.165637033e+00 | Ndiff    0.030 
MERGE @ lap 21.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   21.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.165636939e+00 | Ndiff    0.032 
MERGE @ lap 22.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   22.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.165636838e+00 | Ndiff    0.027 
MERGE @ lap 23.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   23.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.165636714e+00 | Ndiff    0.037 
MERGE @ lap 24.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   24.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.165636535e+00 | Ndiff    0.040 
MERGE @ lap 25.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   25.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.165636247e+00 | Ndiff    0.059 
MERGE @ lap 26.00 : 0/1 accepted. Ndiff 0.00. 0 skipped.
   26.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.165635700e+00 | Ndiff    0.079 
MERGE @ lap 27.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   27.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.165634635e+00 | Ndiff    0.093 
MERGE @ lap 28.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   28.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.165632622e+00 | Ndiff    0.141 
MERGE @ lap 29.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   29.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.165629958e+00 | Ndiff    0.144 
MERGE @ lap 30.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   30.000/300 after      4 sec. |   1612.7 MiB | K   12 | loss  1.165628357e+00 | Ndiff    0.114 
MERGE @ lap 31.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   31.000/300 after      4 sec. |   1612.7 MiB | K   12 | loss  1.165627833e+00 | Ndiff    0.077 
MERGE @ lap 32.00 : 0/1 accepted. Ndiff 0.00. 0 skipped.
   32.000/300 after      4 sec. |   1612.7 MiB | K   12 | loss  1.165627697e+00 | Ndiff    0.032 
MERGE @ lap 33.00 : 0/5 accepted. Ndiff 0.00. 0 skipped.
   33.000/300 after      4 sec. |   1612.7 MiB | K   12 | loss  1.165627655e+00 | Ndiff    0.028 
MERGE @ lap 34.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   34.000/300 after      4 sec. |   1612.7 MiB | K   12 | loss  1.165627640e+00 | Ndiff    0.019 
MERGE @ lap 35.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   35.000/300 after      4 sec. |   1612.7 MiB | K   12 | loss  1.165627633e+00 | Ndiff    0.012 
MERGE @ lap 36.00 : 0/20 accepted. Ndiff 0.00. 0 skipped.
   36.000/300 after      4 sec. |   1612.7 MiB | K   12 | loss  1.165627630e+00 | Ndiff    0.008 
MERGE @ lap 37.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   37.000/300 after      4 sec. |   1612.7 MiB | K   12 | loss  1.165627628e+00 | Ndiff    0.005 
... done. converged.
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0978 0.1092 0.1012 0.0982 0.099  0.0922 0.0984 0.109  0.1018 0.0932]
The cluster evaluation result is 

NMI => 0.8735889749995429
ARS => 0.8636670127019171
HS => 0.9000790474708761
CS => 0.8478785273195079
VM => 0.8731993364681864
Precision: 0.9319470699432892, Recall: 0.974308300395257, fitted: 0, true: 2
Precision: 0.9883268482490273, Recall: 0.9321100917431193, fitted: 1, true: 7
Precision: 0.9755600814663951, Recall: 0.9795501022494888, fitted: 2, true: 0
Precision: 0.9649484536082474, Recall: 0.9194499017681729, fitted: 3, true: 8
Precision: 0.9767932489451476, Recall: 0.9410569105691057, fitted: 4, true: 6
Precision: 0.9850746268656716, Recall: 0.9409368635437881, fitted: 5, true: 3
Precision: 0.9595744680851064, Recall: 0.9111111111111111, fitted: 6, true: 4
Precision: 0.9688888888888889, Recall: 0.9457700650759219, fitted: 7, true: 5
Precision: 0.976303317535545, Recall: 0.8841201716738197, fitted: 8, true: 9
Precision: 1.0, Recall: 0.5567765567765568, fitted: 9, true: 1
Precision: 0.9950738916256158, Recall: 0.36996336996337, fitted: 10, true: 1
Precision: 0.17989417989417988, Recall: 0.06227106227106227, fitted: 11, true: 1
The current ACC is :0.9409428571428572
The current epoch is epoch: 8
WARNING: Found unrecognized keyword args. These are ignored.
  --gamma1
Dataset Summary:
X Data
  total size: 5000 units
  batch size: 1000 units
  num. batches: 5
Allocation Model:  DP mixture with K=0. Concentration gamma0= 5.00
Obs. Data  Model:  Gaussian with full covariance.
Obs. Data  Prior:  Gauss-Wishart on mean and covar of each cluster
  E[  mean[k] ] = 
   [0. 0.]  ...
  E[ covar[k] ] = 
  [[0.1 0. ]
   [0.  0.1]] ...
Initialization:
  initname = /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
  K = 1 (number of clusters)
  seed = 1607680
  elapsed_time: 0.0 sec
Learn Alg: memoVB | task  1/1 | alg. seed: 1607680 | data order seed: 8541952
task_output_path: /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
MERGE @ lap 1.00: Disabled. Cannot plan merge on first lap. Need valid SS that represent whole dataset.
    0.200/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.428755231e+00 |  
    0.400/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.278804524e+00 |  
    0.600/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.223825403e+00 |  
    1.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.180126179e+00 |  
MERGE @ lap 2.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    2.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.177839764e+00 | Ndiff   22.309 
MERGE @ lap 3.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    3.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.177624611e+00 | Ndiff    2.830 
MERGE @ lap 4.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    4.000/300 after      0 sec. |   1612.7 MiB | K   12 | loss  1.177546072e+00 | Ndiff    1.112 
MERGE @ lap 5.00 : 0/30 accepted. Ndiff 0.00. 0 skipped.
    5.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.177493059e+00 | Ndiff    0.865 
MERGE @ lap 6.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
    6.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.177462922e+00 | Ndiff    0.630 
MERGE @ lap 7.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
    7.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.177443301e+00 | Ndiff    0.423 
MERGE @ lap 8.00: No promising candidates, so no attempts.
    8.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.177431258e+00 | Ndiff    0.272 
MERGE @ lap 9.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
    9.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.177424731e+00 | Ndiff    0.211 
MERGE @ lap 10.00: No promising candidates, so no attempts.
   10.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.177421101e+00 | Ndiff    0.152 
MERGE @ lap 11.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   11.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.177419137e+00 | Ndiff    0.165 
MERGE @ lap 12.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   12.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.177417939e+00 | Ndiff    0.101 
MERGE @ lap 13.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   13.000/300 after      1 sec. |   1612.7 MiB | K   12 | loss  1.177417223e+00 | Ndiff    0.106 
MERGE @ lap 14.00: No promising candidates, so no attempts.
   14.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.177416776e+00 | Ndiff    0.070 
MERGE @ lap 15.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   15.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.177416485e+00 | Ndiff    0.068 
MERGE @ lap 16.00: No promising candidates, so no attempts.
   16.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.177416303e+00 | Ndiff    0.055 
MERGE @ lap 17.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   17.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.177416194e+00 | Ndiff    0.052 
MERGE @ lap 18.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   18.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.177416126e+00 | Ndiff    0.037 
MERGE @ lap 19.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   19.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.177416084e+00 | Ndiff    0.029 
MERGE @ lap 20.00: No promising candidates, so no attempts.
   20.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.177416058e+00 | Ndiff    0.020 
MERGE @ lap 21.00 : 0/8 accepted. Ndiff 0.00. 0 skipped.
   21.000/300 after      2 sec. |   1612.7 MiB | K   12 | loss  1.177416043e+00 | Ndiff    0.014 
MERGE @ lap 22.00: No promising candidates, so no attempts.
   22.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.177416033e+00 | Ndiff    0.017 
MERGE @ lap 23.00 : 0/22 accepted. Ndiff 0.00. 0 skipped.
   23.000/300 after      3 sec. |   1612.7 MiB | K   12 | loss  1.177416027e+00 | Ndiff    0.008 
... done. converged.
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.103  0.1084 0.1048 0.0988 0.0982 0.0912 0.0938 0.102  0.0992 0.1006]
The cluster evaluation result is 

NMI => 0.8829281977170559
ARS => 0.8727697717242808
HS => 0.9097759876735867
CS => 0.8568726949117755
VM => 0.8825322317995401
Precision: 0.9474671669793621, Recall: 0.9637404580152672, fitted: 0, true: 2
Precision: 0.9979838709677419, Recall: 0.9611650485436893, fitted: 1, true: 0
Precision: 0.9508196721311475, Recall: 0.9354838709677419, fitted: 2, true: 8
Precision: 0.987603305785124, Recall: 0.9372549019607843, fitted: 3, true: 7
Precision: 0.9791231732776617, Recall: 0.9493927125506073, fitted: 4, true: 3
Precision: 0.9805194805194806, Recall: 0.9658848614072495, fitted: 5, true: 6
Precision: 0.9783080260303688, Recall: 0.9185336048879837, fitted: 6, true: 4
Precision: 0.9868995633187773, Recall: 0.8986083499005965, fitted: 7, true: 9
Precision: 0.9555555555555556, Recall: 0.9429824561403509, fitted: 8, true: 5
Precision: 1.0, Recall: 0.511070110701107, fitted: 9, true: 1
Precision: 0.9914529914529915, Recall: 0.4280442804428044, fitted: 10, true: 1
Precision: 0.20224719101123595, Recall: 0.07331975560081466, fitted: 11, true: 4
The current ACC is :0.9412571428571429
The current epoch is epoch: 9
WARNING: Found unrecognized keyword args. These are ignored.
  --gamma1
Dataset Summary:
X Data
  total size: 5000 units
  batch size: 1000 units
  num. batches: 5
Allocation Model:  DP mixture with K=0. Concentration gamma0= 5.00
Obs. Data  Model:  Gaussian with full covariance.
Obs. Data  Prior:  Gauss-Wishart on mean and covar of each cluster
  E[  mean[k] ] = 
   [0. 0.]  ...
  E[ covar[k] ] = 
  [[0.1 0. ]
   [0.  0.1]] ...
Initialization:
  initname = /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
  K = 1 (number of clusters)
  seed = 1607680
  elapsed_time: 0.0 sec
Learn Alg: memoVB | task  1/1 | alg. seed: 1607680 | data order seed: 8541952
task_output_path: /home/zifeng/Research/DPVAE/mnist_results_new8/Kmax50mnistepoch10batch_iter3scale0.005bs5000rep4sf0.1/1
MERGE @ lap 1.00: Disabled. Cannot plan merge on first lap. Need valid SS that represent whole dataset.
    0.200/300 after      0 sec. |   1625.1 MiB | K   12 | loss  1.398265205e+00 |  
    0.400/300 after      0 sec. |   1625.1 MiB | K   12 | loss  1.270856158e+00 |  
    0.600/300 after      0 sec. |   1625.1 MiB | K   12 | loss  1.214533836e+00 |  
    1.000/300 after      0 sec. |   1625.1 MiB | K   12 | loss  1.174058047e+00 |  
MERGE @ lap 2.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    2.000/300 after      0 sec. |   1625.1 MiB | K   12 | loss  1.172173206e+00 | Ndiff    5.634 
MERGE @ lap 3.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    3.000/300 after      0 sec. |   1625.1 MiB | K   12 | loss  1.172001469e+00 | Ndiff    1.014 
MERGE @ lap 4.00: Disabled. Waiting for lap >= 5 (--m_startLap).
    4.000/300 after      0 sec. |   1625.1 MiB | K   12 | loss  1.171886223e+00 | Ndiff    1.808 
MERGE @ lap 5.00 : 0/30 accepted. Ndiff 0.00. 0 skipped.
    5.000/300 after      1 sec. |   1625.1 MiB | K   12 | loss  1.171748915e+00 | Ndiff    0.749 
MERGE @ lap 6.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
    6.000/300 after      1 sec. |   1625.1 MiB | K   12 | loss  1.171620434e+00 | Ndiff    0.797 
MERGE @ lap 7.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
    7.000/300 after      1 sec. |   1625.1 MiB | K   12 | loss  1.171578544e+00 | Ndiff    0.602 
MERGE @ lap 8.00: No promising candidates, so no attempts.
    8.000/300 after      1 sec. |   1625.1 MiB | K   12 | loss  1.171557381e+00 | Ndiff    0.402 
MERGE @ lap 9.00: No promising candidates, so no attempts.
    9.000/300 after      1 sec. |   1625.1 MiB | K   12 | loss  1.171543877e+00 | Ndiff    0.278 
MERGE @ lap 10.00: No promising candidates, so no attempts.
   10.000/300 after      1 sec. |   1625.1 MiB | K   12 | loss  1.171530535e+00 | Ndiff    0.261 
MERGE @ lap 11.00 : 0/30 accepted. Ndiff 0.00. 0 skipped.
   11.000/300 after      1 sec. |   1625.1 MiB | K   12 | loss  1.171507888e+00 | Ndiff    0.410 
MERGE @ lap 12.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   12.000/300 after      1 sec. |   1625.1 MiB | K   12 | loss  1.171464223e+00 | Ndiff    0.512 
MERGE @ lap 13.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   13.000/300 after      1 sec. |   1625.1 MiB | K   12 | loss  1.171448160e+00 | Ndiff    0.253 
MERGE @ lap 14.00: No promising candidates, so no attempts.
   14.000/300 after      2 sec. |   1625.1 MiB | K   12 | loss  1.171443850e+00 | Ndiff    0.184 
MERGE @ lap 15.00: No promising candidates, so no attempts.
   15.000/300 after      2 sec. |   1625.1 MiB | K   12 | loss  1.171442000e+00 | Ndiff    0.104 
MERGE @ lap 16.00: No promising candidates, so no attempts.
   16.000/300 after      2 sec. |   1625.1 MiB | K   12 | loss  1.171441257e+00 | Ndiff    0.063 
MERGE @ lap 17.00 : 0/30 accepted. Ndiff 0.00. 0 skipped.
   17.000/300 after      2 sec. |   1625.1 MiB | K   12 | loss  1.171440984e+00 | Ndiff    0.042 
MERGE @ lap 18.00 : 0/26 accepted. Ndiff 0.00. 0 skipped.
   18.000/300 after      2 sec. |   1625.1 MiB | K   12 | loss  1.171440871e+00 | Ndiff    0.021 
MERGE @ lap 19.00 : 0/10 accepted. Ndiff 0.00. 0 skipped.
   19.000/300 after      2 sec. |   1625.1 MiB | K   12 | loss  1.171440823e+00 | Ndiff    0.021 
MERGE @ lap 20.00: No promising candidates, so no attempts.
   20.000/300 after      2 sec. |   1625.1 MiB | K   12 | loss  1.171440801e+00 | Ndiff    0.014 
MERGE @ lap 21.00: No promising candidates, so no attempts.
   21.000/300 after      2 sec. |   1625.1 MiB | K   12 | loss  1.171440790e+00 | Ndiff    0.010 
MERGE @ lap 22.00: No promising candidates, so no attempts.
   22.000/300 after      3 sec. |   1625.1 MiB | K   12 | loss  1.171440785e+00 | Ndiff    0.006 
... done. converged.
The true number of cluster is 10
The proportion of image with true cluster in the batch: 

[0.0974 0.1078 0.0966 0.1026 0.1004 0.0898 0.1058 0.1102 0.0924 0.097 ]
The cluster evaluation result is 

NMI => 0.8802338993505381
ARS => 0.87110486350631
HS => 0.906527741511686
CS => 0.8547027102268391
VM => 0.8798527379549115
Precision: 0.9727272727272728, Recall: 0.9709618874773139, fitted: 0, true: 7
Precision: 0.9750479846449136, Recall: 0.9603024574669187, fitted: 1, true: 6
Precision: 0.9496981891348089, Recall: 0.9772256728778468, fitted: 2, true: 2
Precision: 0.9813664596273292, Recall: 0.973305954825462, fitted: 3, true: 0
Precision: 0.9852941176470589, Recall: 0.9142300194931774, fitted: 4, true: 3
Precision: 0.9766949152542372, Recall: 0.9183266932270916, fitted: 5, true: 4
Precision: 0.9534368070953437, Recall: 0.9307359307359307, fitted: 6, true: 8
Precision: 0.9954233409610984, Recall: 0.8969072164948454, fitted: 7, true: 9
Precision: 0.9551886792452831, Recall: 0.9020044543429844, fitted: 8, true: 5
Precision: 1.0, Recall: 0.575139146567718, fitted: 9, true: 1
Precision: 0.19680851063829788, Recall: 0.07370517928286853, fitted: 10, true: 4
Precision: 1.0, Recall: 0.35435992578849723, fitted: 11, true: 1
The current ACC is :0.9417857142857143
The cluster evaluation result is 

NMI => 0.8692270005578152
ARS => 0.8603839763090877
HS => 0.8963919294159302
CS => 0.8428852979422071
VM => 0.8688155822592837
The overall recall across all samples: 0.9417857142857143
Precision: 0.9724453060094157, Recall: 0.9629781982723159, fitted: 0, true: 7
Precision: 0.9841861852901685, Recall: 0.9594240837696335, fitted: 1, true: 6
Precision: 0.9499788643088629, Recall: 0.9645207439198855, fitted: 2, true: 2
Precision: 0.9818660427025446, Recall: 0.9726205997392438, fitted: 3, true: 0
Precision: 0.9774127310061602, Recall: 0.933202632684498, fitted: 4, true: 3
Precision: 0.9746993596751523, Recall: 0.9145662368112544, fitted: 5, true: 4
Precision: 0.9502200637426013, Recall: 0.9173626373626373, fitted: 6, true: 8
Precision: 0.9797059763502717, Recall: 0.8811440068985341, fitted: 7, true: 9
Precision: 0.9582917912927883, Recall: 0.9135118010454617, fitted: 8, true: 5
Precision: 0.9985822306238186, Recall: 0.536498667005205, fitted: 9, true: 1
Precision: 0.20471333098839253, Recall: 0.07388599720705852, fitted: 10, true: 1
Precision: 0.9993286337697214, Recall: 0.37793576234607085, fitted: 11, true: 1
